<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>LAMMPS on ARCHER2 for DEM simulations: Setting up a simulation in LAMMPS</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/swc/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/swc/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/swc/favicon-16x16.png"><link rel="manifest" href="../favicons/swc/site.webmanifest"><link rel="mask-icon" href="../favicons/swc/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav software"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="swc-logo" alt="A course on runing DEM simulations on ARCHER2 for the CCC-ParaSolS community" src="../assets/images/software-logo.svg"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../03-simulation-setup.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav software" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="A course on runing DEM simulations on ARCHER2 for the CCC-ParaSolS community" src="../assets/images/software-logo-sm.svg"></div>
    <div class="lesson-title-md">
      LAMMPS on ARCHER2 for DEM simulations
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            LAMMPS on ARCHER2 for DEM simulations
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  LAMMPS on ARCHER2 for DEM simulations
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 21%" class="percentage">
    21%
  </div>
  <div class="progress software">
    <div class="progress-bar software" role="progressbar" style="width: 21%" aria-valuenow="21" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../03-simulation-setup.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-welcome.html">1. Welcome</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-connecting.html">2. Connecting to ARCHER2 and transferring data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-lammps-on-archer2.html">3. An introduction to LAMMPS on ARCHER2</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Setting up a simulation in LAMMPS
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#intro-to-lammps-simulations">Intro to LAMMPS simulations</a></li>
<li><a href="#simulation-setup">Simulation setup</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-understanding-logfile.html">5. Understanding the logfile</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-advanced-io-commands.html">6. Advanced input and output commands</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="06-lammps-performance.html">7. Measuring and improving LAMMPS performance</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/02-lammps-on-archer2.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/04-understanding-logfile.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/02-lammps-on-archer2.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: An introduction to
        </a>
        <a class="chapter-link float-end" href="../instructor/04-understanding-logfile.html" rel="next">
          Next: Understanding the...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Setting up a simulation in LAMMPS</h1>
        <p>Last updated on 2025-10-12 |

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/03-simulation-setup.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>“How do we setup a simulation in LAMMPS?”</li>
<li>“What do all the commands in the input file mean?”</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>“Understand the commands, keywords, and parameters necessary to
setup a LAMMPS simulation.”</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="intro-to-lammps-simulations">Intro to LAMMPS simulations<a class="anchor" aria-label="anchor" href="#intro-to-lammps-simulations"></a></h2>
<hr class="half-width"><p>LAMMPS uses text files as input files that control the setup and flow
of a simulation, and a variety of file types (and other methods) initial
system for topologies.</p>
<p>Whether the simulation to run is MD or DEM, LAMMPS applies Newton’s
laws of motion to systems of particles that can range in size from
atoms, course-grained moieties, entire molecules, or even grains of
sand. In practical terms, the movement of the particles is calculated by
the simple repeating loop:</p>
<ol style="list-style-type: decimal"><li>Take the initial positions of the particles in the simulation box
and calculate the total force that is applied to each particle, using
the chosen force-field.</li>
<li>Use the calculated forces to calculate the acceleration to add to
each particle.</li>
<li>Use the acceleration to calculate the new velocity of each
particle.</li>
<li>Use the the new velocity of each particle, and the defined
time-step, to calculate a new position for each particle.</li>
<li>Repeat ad nauseum.</li>
</ol><p>With the new particle positions, the cycle continues, one very small
time-step at a time.</p>
<figure><img src="../fig/MD.png" alt="Minimalistic representation of a 2D simulation of particles" class="figure mx-auto d-block"><div class="figcaption">Minimalistic representation of a 2D simulation
of particles</div>
</figure><p>With this in mind, we can take a look at a very simple example of a
LAMMPS input file, <code>in.pour</code>, and discuss each command – and
their related concepts – one by one. The order that the commands appear
in <strong>can</strong> be important, depending on the exact details.
Always refer to the <a href="lammps-manual">LAMMPS manual</a> to
check.</p>
<p>For this session, we’ll be looking at the
<code>2-pour-exercise/in.pour</code> file in your <code>exercises</code>
directory.</p>
</section><section><h2 class="section-heading" id="simulation-setup">Simulation setup<a class="anchor" aria-label="anchor" href="#simulation-setup"></a></h2>
<hr class="half-width"><p>The first thing we have to do is chose a style of units. This can be
achieved by the <code>units</code> command:</p>
<pre><code>units         lj</code></pre>
<p>LAMMPS has several different <a href="https://docs.lammps.org/units.html" class="external-link">unit styles</a>, useful in
different types of simulations. In this example, we are using
<code>lj</code>, or Lennard-Jones (LJ) units. These are dimensionless
units, that are defined on the LJ potential parameters. They are
computationally advantageous because they’re usually close to unity, and
required less precise (lower number of bits) floating point variables –
which in turn reduced the memory requirements, and increased calculation
speed.</p>
<p>The next line defines what style of <code>atoms</code> (LAMMPS’s
terminology for particle) to use:</p>
<pre><code>atom_style    sphere</code></pre>
<p>The <a href="https://docs.lammps.org/atom_style.html" class="external-link">atom style</a>
impacts on what attributes each atom has associated with it – this
cannot be changed during a simulation. Every style stores: coordinates,
velocities, atom IDs, and atom types. The <code>sphere</code> style also
stores radius, mass, omega, and torque for each particle. Other styles
will store additional, or different, information.</p>
<p>We then define the number of dimensions in our system:</p>
<pre><code>dimension     3</code></pre>
<p>LAMMPS is also capable of simulating two-dimensional systems.</p>
<p>The boundary command sets the styles for the boundaries for the
simulation box.</p>
<pre><code>boundary      p p f</code></pre>
<p>Each of the three letters after the keyword corresponds to a
direction (x, y, z), and <code>p</code> means that the selected boundary
is to be periodic, while <code>f</code> means it’s fixed, that is,
LAMMPS won’t generate periodic images accross this dimension, and
particles won’t be able to go accross the limits of the simulation box
accross this dimension. Other boundary conditions are available
(shrink-wrapped, and shrink-wrapped with minimum).</p>
<figure><img src="../fig/PBC.png" alt="Periodic boundary conditions" class="figure mx-auto d-block"><div class="figcaption">Periodic boundary conditions</div>
</figure><p>Periodic boundary conditions (PBCs) allow the approximation of an
infinite system by simulating only a small part, a unit-cell. The most
common shapes of (3D) unit-cell is cuboidal, but any shape that
completely tessellates 3D space can be used. The topology of PBCs is
such that a particle leaving one side of the unit cell, it reappears on
the other side. A 2D map with PBC could be perfectly mapped to a
torus.</p>
<p>Another key aspect of using PBCs is the use of the
<strong>minimum-image convention</strong> for calculating interactions
between particles. This guarantees that each particle interacts only
with the closest <em>image</em> of another particle, no matter with
unit-cell (the original simulation box or one of the periodic images) it
belongs to.</p>
<p>Granular interactions depend on the velocity of neighbouring
particles, so we need to setup LAMMPS to communicate the velocities of
“ghost” particles between processors:</p>
<pre><code>comm_modify     vel yes</code></pre>
<p>The region command defines a geometric region in space.</p>
<pre><code>region          reg block -20 20 -20 20 0 40</code></pre>
<p>The arguments are <code>box</code>, a name we give to the region,
<code>block</code>, the type of region (cuboid), and the numbers are the
min and max values for x, y, and z.</p>
<p>We then create a box with two “atom” types, using the region we
defined previously</p>
<pre><code>create_box      2 reg</code></pre>
<div class="section level3">
<h3 id="inter-particle-interactions">Inter-particle interactions<a class="anchor" aria-label="anchor" href="#inter-particle-interactions"></a></h3>
<p>Now that we have a simulation box, we have to define how particles
will interact with each-other once we start adding them to the box.</p>
<p>The first line in this section defines the style of interaction our
particles will use.</p>
<pre><code>pair_style  granular</code></pre>
<p>LAMMPS has a large number of <a href="https://docs.lammps.org/pair_style.html" class="external-link">pairwise interparticle
interactions</a> available. In this case, we are using the granular pair
style, which supports a number of options for normal, tangential,
rolling, and twisting forces that result from the contact between
particles that need to be setup, using the commands:</p>
<pre><code>pair_coeff      1 * jkr 1000.0 50.0 0.3 10 tangential mindlin 800.0 1.0 0.5 rolling sds 500.0 200.0 0.5 twisting marshall
pair_coeff      2 2 hertz 200.0 20.0 tangential linear_history 300.0 1.0 0.1 rolling sds 200.0 100.0 0.1 twisting marshall</code></pre>
</div>
<div class="section level3">
<h3 id="neighbour-lists">Neighbour lists<a class="anchor" aria-label="anchor" href="#neighbour-lists"></a></h3>
<p>To improve simulation performance, and because we are truncating
interactions at a certain distance, we can keep a list of particles that
are close to each other (under a neighbour cutoff distance). This
reduces the number of comparisons needed per time-step, at the cost of a
small amount of memory.</p>
<p>{% include figure.html url=“” max-width=“30%”
file=“/fig/2_MD-primer/cutoff.png” alt=“Neighbour lists” %}</p>
<p>We can set our neighbour list cutoff to be 0.3σ greater than the
default cutoff – remember that, as we are dealing with spheres, a small
increase in radius results can result in a large volume increase.</p>
<p>The <code>bin</code> keyword refers to the algorithm used to build
the list, <code>bin</code> is the best performing algorithm for systems
with homogeneous sizes of particles, but there are <a href="https://docs.lammps.org/neighbor.html" class="external-link">others</a>.</p>
<pre><code>neighbor        0.3 bin</code></pre>
<p>These lists still need to be updated periodically. Provided that we
rebuild them more frequently than the minimum time it takes for a
particle to move from within the neighbour cutoff to outside of it. We
use the <code>neigh_modify</code> command to set the wait time between
each neighbour list rebuild:</p>
<pre><code>neigh_modify    delay 10 every 1</code></pre>
<p>The <code>delay</code> parameter sets the minimum number of
time-steps that need to pass since the last neighbour list rebuild for
LAMMPS to even consider rebuilding it again. The <code>every</code>
parameter tells LAMMPS to attempt to build the neighbour list if the
number of timesteps since the delay ended is equal to the
<code>every</code> value – by default, the rebuild will only be
triggered if an atom has moved more than half the neighbour skin
distance (the 0.3 above).</p>
<div id="how-to-set-neighbour-list-delays" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="how-to-set-neighbour-list-delays" class="callout-inner">
<h3 class="callout-title">How to set neighbour list delays?</h3>
<div class="callout-content">
<p>You can estimate the frequency at which you need to rebuild neighbour
lists by running a quick simulation with neighbour list rebuilds every
timestep:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">neigh_modify</span>    delay 0 every 1 check yes</span></code></pre>
</div>
<p>and looking at the resultant LAMMPS neighbour list information in the
log file generated by that run.</p>
<p>The Neighbour list builds tells you how often neighbour lists needed
to be rebuilt. If you know how many timesteps your short simulation ran
for, you can estimate the frequency at which you need to calculate
neighbour lists by working out how many steps there are per rebuild on
average. Provided that your update frequency is less than or equal to
that, you should see a speed up.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="simulation-parameters">Simulation parameters<a class="anchor" aria-label="anchor" href="#simulation-parameters"></a></h3>
<p>Now that we’ve set up the initial conditions for the simulation, and
changed some settings to make sure it runs a bit faster, all that is
left is telling LAMMPS exactly how we want the simulation to be run.
This includes, but is not limited to, what ensemble to use (and which
particles to apply it to), how big the time-step is, how many time-steps
we want to simulate, what properties we want as output, and how often we
want those properties logged.</p>
<p>The <code>fix</code> command has a <a href="https://docs.lammps.org/fix.html" class="external-link">myriad of options</a>, most of
them related to ‘setting’ certain properties at a value, or in an
interval of values for one, all, or some particles in the
simulation.</p>
<p>The first keywords are always <code>ID</code> – a name to reference
the fix by, and <code>group-ID</code> – which particles to apply the
command to. The most common option for the second keyword is
<code>all</code>.</p>
<pre><code>fix             1 all nve/sphere</code></pre>
<p>Then we have the styles plus the arguments. In the case above, the
style is <code>nve/sphere</code>, and there are no arguments.</p>
<p>Next, we enable gravity on our simulation:</p>
<pre><code>fix             grav all gravity 9.8 vector 0 0 -1</code></pre>
</div>
<div class="section level3">
<h3 id="pouring-particles">Pouring particles<a class="anchor" aria-label="anchor" href="#pouring-particles"></a></h3>
<p>To pour particles into our box, we need to setup a region where
particles can appear. We can create two cylindrical regions with the
commands:</p>
<pre><code>region          cyl1 cylinder z -10  9 10 20 35
region          cyl2 cylinder z  10 -9 10 20 35</code></pre>
<p>Here, the parameters after <code>cylinder</code> are: the direction
of the axis of the cylinder, the coordinates of the axis in the other
two dimensions, the radius, and the low- and high- coordinate along the
axis of the cylinder faces.</p>
<p>Then, we use the <code>fix pour</code> command to create particles in
our simulation box.</p>
<pre><code>#               ID   group-id style n_part type seed kw     region_id kw   d_style min_diam max_diam kw   min_dens max_dens
fix             ins1 all      pour  10000  1    3123 region cyl1      diam range   0.5      1        dens 1.0      1.0
fix             ins2 all      pour  10000  2    4567 region cyl2      diam range   0.5      1        dens 1.0      1.0</code></pre>
<p>Finally, we setup the properties of our bottom wall:</p>
<pre><code>fix             2 all wall/gran granular hertz/material 1e5 1e3 0.3 tangential mindlin NULL 1.0 0.5 zplane 0 NULL</code></pre>
</div>
<div class="section level3">
<h3 id="final-setup">Final setup<a class="anchor" aria-label="anchor" href="#final-setup"></a></h3>
<p>To have a valid simulation setup, we need to set the size of the
time-step, in whatever units we have chosen for this simulation – in
this case, LJ units.</p>
<pre><code>timestep      0.001</code></pre>
<p>The size of the time-step is a careful juggling of speed and
accuracy. A small time-step guarantees that no particle interactions are
missing, at the cost of a lot of computation time. A large time-step
allows for simulations that probe effects at longer time scales, but
risks a particle moving so much in each time-step, that some
interactions are missed – in extreme cases, some particles can ‘fly’
right through each other. The ‘happy medium’ depends on the system type,
size, and other variables.</p>
<p>The next line sets what thermodynamic information we want LAMMPS to
output to the terminal and the log file.</p>
<pre><code>thermo_style  custom step atoms</code></pre>
<p>There are several default styles, and the <code>custom</code> style
allows for full customisation of which fields and in which order to
write them.</p>
<p>In MD simulations (LAMMPS original use-case), losing an atom during
the simulation is a catastrophic mistake, so by default LAMMPS
terminates any simulation that looses particles with an error. To change
this behaviour for DEM simulations, use the <code>thermo_modify</code>
command:</p>
<pre><code>thermo_modify   lost ignore</code></pre>
<p>To set the frequency (in time-steps) at which these results are
output, you can vary the <code>thermo</code> command:</p>
<pre><code>thermo        100</code></pre>
<p>In this case, an output will be printed every 100 time-steps.</p>
<p>We can then select how to output the output trajectory files, we give
here two distinct options for different visualisation programs:</p>
<pre><code># for Ovito:
dump            1 all custom 100 dump.pour id type radius mass x y z
# for VTK:
dump            2 all vtk 100 pour*.vtk id type radius mass x y z
dump_modify     2 binary yes</code></pre>
<div id="nb---using-vtk" class="callout caution">
<div class="callout-square">
<i class="callout-icon" data-feather="alert-triangle"></i>
</div>
<span class="callout-header">Caution</span>
<div id="nb---using-vtk" class="callout-inner">
<h3 class="callout-title">NB - Using VTK</h3>
<div class="callout-content">
<p>For LAMMPS to be able to output in the VTK format, the executable
being used needs to have been compiled with the VTK package support.
This requires the system being used to have the VTK library installed.
The current version of LAMMPS on ARCHER2 does <em>not</em> have VTK
support.</p>
</div>
</div>
</div>
<p>And finally, we choose how many time-steps (<strong>not
time-units</strong>) to run the simulation for:</p>
<pre><code>run           10000</code></pre>
<div id="run-pour-simulation" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="run-pour-simulation" class="callout-inner">
<h3 class="callout-title">Run pour simulation</h3>
<div class="callout-content">
<p>What command does it take to submit the simulation to the ARCHER2
queue? What was the output?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">sbatch</span> sub.slurm</span></code></pre>
</div>
<p>We will inspect the logfile in detail on the next session.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul><li>“LAMMPS can simulate systems of many particles that are allowed to
interact, using any of a number of contact models.”</li>
<li>“A LAMMPS input file is a an ordered collection of commands with
both mandatory and optional arguments.”</li>
<li>“To successfully run a LAMMPS simulation, an input file needs to
cover basic simulation setup, read/create a system topology,
force-field, and type/frequency of outputs.”</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/02-lammps-on-archer2.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/04-understanding-logfile.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/02-lammps-on-archer2.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: An introduction to
        </a>
        <a class="chapter-link float-end" href="../instructor/04-understanding-logfile.html" rel="next">
          Next: Understanding the...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/03-simulation-setup.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/" class="external-link">Source</a></p>
				<p><a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:r.apostolo@epcc.ed.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.17.1" class="external-link">sandpaper (0.17.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.7" class="external-link">varnish (1.0.7)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://EPCCed.github.io/archer2-lammps-ccc-parasols/instructor/03-simulation-setup.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, lammps, archer2, dem",
  "name": "Setting up a simulation in LAMMPS",
  "creativeWorkStatus": "active",
  "url": "https://EPCCed.github.io/archer2-lammps-ccc-parasols/instructor/03-simulation-setup.html",
  "identifier": "https://EPCCed.github.io/archer2-lammps-ccc-parasols/instructor/03-simulation-setup.html",
  "dateCreated": "2025-10-15",
  "dateModified": "2025-10-12",
  "datePublished": "2025-10-12"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

