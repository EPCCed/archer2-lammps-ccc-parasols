<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>LAMMPS on ARCHER2 for DEM simulations: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/swc/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicons/swc/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicons/swc/favicon-16x16.png">
<link rel="manifest" href="../favicons/swc/site.webmanifest">
<link rel="mask-icon" href="../favicons/swc/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav software"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="swc-logo" alt="A course on runing DEM simulations on ARCHER2 for the CCC-ParaSolS community" src="../assets/images/software-logo.svg"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav software" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="A course on runing DEM simulations on ARCHER2 for the CCC-ParaSolS community" src="../assets/images/software-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      LAMMPS on ARCHER2 for DEM simulations
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            LAMMPS on ARCHER2 for DEM simulations
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  LAMMPS on ARCHER2 for DEM simulations
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress software">
    <div class="progress-bar software" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-welcome.html">1. Welcome</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-connecting.html">2. Connecting to ARCHER2 and transferring data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-lammps-on-archer2.html">3. An introduction to LAMMPS on ARCHER2</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-simulation-setup.html">4. Setting up a simulation in LAMMPS</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-understanding-logfile.html">5. Understanding the logfile</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-advanced-io-commands.html">6. Advanced input and output commands</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="06-lammps-performance.html">7. Measuring and improving LAMMPS performance</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="07-compile.html">8. Compiling LAMMPS</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="08-lammps-python.html">9. Running LAMMPS through Python</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-welcome"><p>Content from <a href="00-welcome.html">Welcome</a></p>
<hr>
<p>Last updated on 2025-10-12 |

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/00-welcome.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 10 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“What can I expect from this course?”</li>
<li>“How will the course work and how will I get help?”</li>
<li>“How can I give feedback to improve the course?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Understand how this course works, how I can get help and how I can
give feedback.”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="course-structure-and-method">Course structure and method<a class="anchor" aria-label="anchor" href="#course-structure-and-method"></a>
</h2>
<hr class="half-width">
<p>Rather than having separate lectures and practical sessions, this
course is taught following <a href="https://carpentries.org" class="external-link">The
Carpentries methodology</a> where we all work together through material
learning key skills and information throughout the course. Typically,
this follows the method of the instructor demonstrating and then the
attendees doing along with the instructor.</p>
<p>The instructors are available to assist you and to answer any
questions you may have as we work through the material together. You
should feel free to ask questions of the instructor whenever you like.
The instructor will also provide many opportunities to pause and ask
questions.</p>
<p>We will also make use of a shared collaborative document - the
<em>etherpad</em>. You will find a link to this collaborative document
on the <a href="https://www.archer2.ac.uk/training/courses/251014-lammps/" class="external-link">course
page</a>. We will use it for a number of different purposes, for
example, it may be used during exercises and instructors and helpers may
put useful information or links in the etherpad that help or expand on
the material being taught. If you have useful information to share with
the class then please do add it to the etherpad. At the end of the
course, we take a copy of the information in the etherpad, remove any
personally-identifiable information, and post this on the course archive
page so you should always be able to come back and find any information
you found useful.</p>
<div id="introductions" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="introductions" class="callout-inner">
<h3 class="callout-title">Introductions</h3>
<div class="callout-content">
<p>Let’s use the etherpad to introduce ourselves. Please go to this
course’s etherpad and let us know the following: - Your name - Your
place of work - Whether this is your first time using ARCHER2? - Whether
this is your first time using LAMMPS? - Why are you interested in
learning how to use LAMMPS? - What systems are you looking to
simulate?</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="feedback">Feedback<a class="anchor" aria-label="anchor" href="#feedback"></a>
</h2>
<hr class="half-width">
<p>Feedback is integral to how we approach training both during and
after the course. In particular, we use informal and structured feedback
activities during the course to ensure we tailor the pace and content
appropriately for the attendees, and feedback after the course to help
us improve our training for the future.</p>
<p>You will be issued with red and green “stickies” (or shown how to use
their virtual equivalent for online courses) to allow you to give the
instructor and helpers quick visual feedback on how you are getting on
with the pace and the content of the course. If you are comfortable with
the pace/content then you should place your green sticky on the back of
your laptop; if you are stuck, have questions, or are struggling with
the pace/content then you should place the red sticky on the back of
your laptop and a helper will come and speak to you. The instructor may
also ask you to use the stickies in other, specific situations.</p>
<p>At the lunch break (and end of days for multi-day courses) we will
also run a quick feedback activity to gauge how the course is matching
onto attendees requirements. Instructors and helpers will review this
feedback over lunch, or overnight, provide a summary of what we found at
the start of the next session and, potentially, how the upcoming
material/schedule will be changed to address the feedback.</p>
<p>Finally, you will be provided with the opportunity to provide
feedback on the course after it has finished. We welcome all this
feedback, both good and bad, as this information in key to allow us to
continually improve the training we offer.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“The course will be flexible to best meet the learning needs of the
attendees.”</li>
<li>“Feedback is an essential part of our training to allow us to
continue to improve and make sure the course is as useful as possible to
attendees.”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-01-connecting"><p>Content from <a href="01-connecting.html">Connecting to ARCHER2 and transferring data</a></p>
<hr>
<p>Last updated on 2025-10-12 |

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/01-connecting.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 5 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“How can I access ARCHER2 interactively?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Understand how to connect to ARCHER2.”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<hr class="half-width">
<p>Attendees of this course will get access to the ARCHER2 HPC facility.
You will have the ability to request an account and to login to ARCHER2
before the course begins. In this session, we will talk you through
getting access to ARCHER2. Please be aware that you will need to follow
the <a href="https://www.archer2.ac.uk/training/code-of-conduct/" class="external-link">ARCHER2 Code
of Conduct</a> as a condition for access.</p>
<p>Note that if you are not able to login to ARCHER2 and do not attend
this session, you may struggle to run the course exercises as these were
designed to run on ARCHER2 specifically.</p>
</section><section><h2 class="section-heading" id="connecting-using-ssh">Connecting using SSH<a class="anchor" aria-label="anchor" href="#connecting-using-ssh"></a>
</h2>
<hr class="half-width">
<p>The ARCHER2 login address is</p>
<pre><code><span><span class="va">login.archer2.ac.uk</span></span></code></pre>
<p>To login using ssh, use the command:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">ssh</span> username@login.archer2.ac.uk</span></code></pre>
</div>
<p>Access to ARCHER2 is via SSH using <strong>both</strong> a password
and a passphrase-protected SSH key pair.</p>
</section><section><h2 class="section-heading" id="passwords-and-password-policy">Passwords and password policy<a class="anchor" aria-label="anchor" href="#passwords-and-password-policy"></a>
</h2>
<hr class="half-width">
<p>When you first get an ARCHER2 account, you will get a single-use
password from the SAFE which you will be asked to change to a password
of your choice. Your chosen password must have the required complexity
as specified in the <a href="https://www.archer2.ac.uk/about/policies/passwords_usernames.html" class="external-link">ARCHER2
Password Policy</a>.</p>
<p>The password policy has been chosen to allow users to use both
complex, shorter passwords and long, but comparatively simple passwords.
For example, passwords in the style of both <code>LA10!£lsty</code> and
<code>correcthorsebatterystaple</code> would be supported.</p>
</section><section><h2 class="section-heading" id="ssh-keys">SSH keys<a class="anchor" aria-label="anchor" href="#ssh-keys"></a>
</h2>
<hr class="half-width">
<p>As well as password access, users are required to add the public part
of an SSH key pair to access ARCHER2. The public part of the key pair is
associated with your account using the SAFE web interface. See the
ARCHER2 User and Best Practice Guide for information on how to create
SSH key pairs and associate them with your account:</p>
<ul>
<li><a href="https://docs.archer2.ac.uk/user-guide/connecting/" class="external-link">Connecting to
ARCHER2</a></li>
</ul></section><section><h2 class="section-heading" id="mfatotp">MFA/TOTP<a class="anchor" aria-label="anchor" href="#mfatotp"></a>
</h2>
<hr class="half-width">
<p>Multi-factor authentication, under the form of timed one-time
passwords, are now mandatory on ARCHER2 accounts. To create one, please
follow the instructions in our <a href="https://docs.archer2.ac.uk/user-guide/connecting/#mfa-time-based-one-time-passcode-totp-code" class="external-link">SAFE
documentation</a>.</p>
</section><section><h2 class="section-heading" id="data-transfer-services-scp-rsync">Data transfer services: scp, rsync<a class="anchor" aria-label="anchor" href="#data-transfer-services-scp-rsync"></a>
</h2>
<hr class="half-width">
<p>ARCHER2 supports a number of different data transfer mechanisms. The
one you choose depends on the amount and structure of the data you want
to transfer and where you want to transfer the data to. The two main
options are:</p>
<ul>
<li>
<code>scp</code>: The standard way to transfer small to medium
amounts of data off ARCHER2 to any other location</li>
<li>
<code>rsync</code>: Used if you need to keep small to medium
data-sets synchronised between two different locations</li>
</ul>
<p>More information on data transfer mechanisms can be found in the
ARCHER2 User and Best Practice Guide:</p>
<ul>
<li><a href="https://docs.archer2.ac.uk/user-guide/data/" class="external-link">Data
management and transfer</a></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“ARCHER2’s login address is <code>login.archer2.ac.uk</code>.”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-02-lammps-on-archer2"><p>Content from <a href="02-lammps-on-archer2.html">An introduction to LAMMPS on ARCHER2</a></p>
<hr>
<p>Last updated on 2025-10-12 |

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/02-lammps-on-archer2.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“What is LAMMPS?”</li>
<li>“How do I run jobs in ARCHER2?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Understand what LAMMPS is.”</li>
<li>“Learn how to launch jobs on ARCHER2 using the slurm batch
system.”</li>
<li>“Run a LAMMPS benchmark exercise to see how benchmarking can help
improve code performance.”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="archer2-system-overview">ARCHER2 system overview<a class="anchor" aria-label="anchor" href="#archer2-system-overview"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="architecture">Architecture<a class="anchor" aria-label="anchor" href="#architecture"></a>
</h3>
<p>The ARCHER2 HPE Cray EX system consists of a number of different node
types. The ones visible to users are:</p>
<ul>
<li>Login nodes</li>
<li>Compute nodes</li>
<li>Data analysis (pre-/post- processing) nodes</li>
</ul>
<p>All of the non-GPU node types have the same processors: AMD
EPYC<sup>TM</sup> 7742, 2.25GHz, 64-cores. All non-GPU nodes are dual
socket nodes so there are 128 cores per node.</p>
<figure><img src="../fig/archer2_architecture.png" alt="Image explaining the archer2 hardware Architecture" class="figure mx-auto d-block"><div class="figcaption">ARCHER2 Architecture</div>
</figure>
</div>
<div class="section level3">
<h3 id="compute-nodes">Compute nodes<a class="anchor" aria-label="anchor" href="#compute-nodes"></a>
</h3>
<p>There are 5,860 CPU compute nodes in total, giving 750,080 compute
cores on the full ARCHER2 system. There are also 4 GPU nodes for
software development. Most of these (5,276 nodes) have 256 GiB memory
per node, a smaller number (584 nodes) have 512 GiB memory per node. All
of the compute nodes are linked together using the high-performance HPE
Slingshot interconnect.</p>
<p>Access to the compute nodes is controlled by the Slurm scheduling
system which supports both batch jobs and interactive jobs.</p>
<p>Compute node summary:</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="37%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>CPU Nodes</th>
<th>GPU Nodes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Processors</td>
<td>2x AMD EPYC Zen2 (Rome) 7742, 2.25 GHz, 64-core</td>
<td>1x AMD EPYC Zen3 7543P (Milan), 2.8GHz, 32-core</td>
</tr>
<tr class="even">
<td>Cores per node</td>
<td>128</td>
<td>32</td>
</tr>
<tr class="odd">
<td>NUMA</td>
<td>8 NUMA regions per node, 16 cores per NUMA region</td>
<td>4 NUMA regions, 8 cores per NUMA region</td>
</tr>
<tr class="even">
<td>Memory Capacity</td>
<td>256/512 GiB DDR4 3200MHz, 8 memory channels</td>
<td>512 GiB DDR4 3200MHz, 8 memory channels</td>
</tr>
<tr class="odd">
<td>Memory Bandwidth</td>
<td>&gt;380 GB/s per node</td>
<td>40 GB/s (Host-Device), 80GB/s (Device-Device)</td>
</tr>
<tr class="even">
<td>Interconnect Bandwidth</td>
<td>25 GB/s per node bi-directional</td>
<td>25 GB/s per node bi-directional</td>
</tr>
<tr class="odd">
<td>Accelerators</td>
<td>None</td>
<td>4x AMD Instinct MI210, 104 compute units, 64GiB HBM2e memory</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="storage">Storage<a class="anchor" aria-label="anchor" href="#storage"></a>
</h3>
<p>There are four different storage systems available on the current
ARCHER2 service:</p>
<ul>
<li>Home file systems: <code>/home</code>
</li>
<li>Work file systems: <code>/work</code>
</li>
<li>Solid-state file system (scratch): <code>/scratch-nvme</code>
</li>
<li>RDF as a Service (RDFaaS): <code>/epsrc</code>
</li>
</ul>
</div>
</section><section><h2 class="section-heading" id="what-is-lammps">What is LAMMPS?<a class="anchor" aria-label="anchor" href="#what-is-lammps"></a>
</h2>
<hr class="half-width">
<p>LAMMPS (Large-scale Atomic/Molecular Massively Parallel Simulator) is
a versatile classical molecular dynamics software package that has been
extended to be useful to many other domains, including coarse-grained
MD, discrete element method, hydrodynamics, lattice boltzmann,
peridynamics, etc. It is developed by Sandia National Laboratories and
by its wide user-base under GPLv2.</p>
<p>It can be downloaded from the <a href="https://lammps.sandia.gov/download.html" class="external-link">LAMMPS website</a></p>
<p>Everything we are covering today (and a lot of other info) can be
found in the <a href="https://lammps.sandia.gov/doc/Manual.html" class="external-link">LAMMPS
User Manual</a></p>
</section><section><h2 class="section-heading" id="using-a-lammps-module-on-archer2">Using a LAMMPS module on ARCHER2<a class="anchor" aria-label="anchor" href="#using-a-lammps-module-on-archer2"></a>
</h2>
<hr class="half-width">
<p>ARCHER2 uses a module system. In general, you can run LAMMPS on
ARCHER2 by using the LAMMPS module. You can use the
<code>module spider</code> command to list all available versions of a
module, and their dependencies:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">user@ln01:~</span><span class="op">&gt;</span> module spider lammps</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>---------------------------------------------------------------------
  lammps:
---------------------------------------------------------------------
     Versions:
        lammps/2Aug2024-GPU
        lammps/13Feb2024
        lammps/15Dec2023
        lammps/17Feb2023
        lammps/29Aug2024
     Other possible modules matches:
        cpl-lammps  cpl-openfoam-lammps  lammps-gpu  lammps-python

----------------------------------------------------------------------
  To find other possible module matches execute:

      $ module -r spider '.*lammps.*'

----------------------------------------------------------------------
  For detailed information about a specific "lammps" package
  (including how to load the modules) use the module's full name.
  Note that names that have a trailing (E) are extensions provided
  by other modules.
  For example:

     $ module spider lammps/29Aug2024
----------------------------------------------------------------------</code></pre>
</div>
<p>Running <code>module load lammps</code> will set up your environment
to use the default LAMMPS module on ARCHER2. For this course, we will be
using the 29 August, 2024 version of LAMMPS:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">module</span> load lammps/29Aug2024</span></code></pre>
</div>
<p>Once your environment is set up, you will have access to the
<code>lmp</code> LAMMPS executable. Note that you will only be able to
run this on a single core on the ARCHER2 login node.</p>
</section><section><h2 class="section-heading" id="running-lammps-on-archer2-compute-nodes">Running LAMMPS on ARCHER2 compute nodes<a class="anchor" aria-label="anchor" href="#running-lammps-on-archer2-compute-nodes"></a>
</h2>
<hr class="half-width">
<p>We will now launch a first LAMMPS job from the compute nodes. The
login nodes are shared resources on which we have limited the amount of
cores that can be used for a job. To run LAMMPS simulations on a large
number of cores, we must use the compute nodes.</p>
<p>The <code>/home</code> file system is not accessible from the compute
nodes. As such, we will need to submit our jobs from the
<code>/work</code> directory. Every user has a directory in
<code>/work</code> associated to their project code. For this course,
the project code is <code>ta215</code>, so we all have a directory
called: <code>/work/ta215/ta215/&lt;username&gt;</code> (make sure to
replace <code>username</code> with your username).</p>
<p>We have prepared a number of exercises for today. You can either
download these by either:</p>
<div class="section level3">
<h3 id="using-git">Using <code>git</code>
<a class="anchor" aria-label="anchor" href="#using-git"></a>
</h3>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/EPCCed/archer2-lammps-ccc-parasols.git</span></code></pre>
</div>
<p>and then navigating to the <code>exercises folder</code> with:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="bu">cd</span> archer2-archer2-lammps-ccc-parasols/exercises</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="copy-from-workta215shared">Copy from <code>/work/ta215/shared</code>
<a class="anchor" aria-label="anchor" href="#copy-from-workta215shared"></a>
</h3>
<p>or by copying it from the shared part of the <code>ta215</code>
project directory:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">cp</span> <span class="at">-r</span> /work/ta215/shared/exercises ./</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="exercise-1">Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<p>For this session, we’ll be looking at
<code>exercises/1-performance-exercise/</code>.</p>
<p>In this directory you will find three files:</p>
<ul>
<li>
<code>sub.slurm</code> is a Slurm submission script. This will let
you submit jobs to the compute nodes. As written, it will run a
single-core job but we will be editing it to run on more cores.</li>
<li>
<code>in.ethanol</code> is the LAMMPS input script that we will be
using for this exercise. This script will run a small simulation of 125
ethanol molecules.</li>
<li>
<code>data.ethanol</code> is a LAMMPS data file for a single ethanol
molecule. This single molecule will be replicated by LAMMPS to generate
the system inside the simulation box.</li>
</ul>
<div id="why-ethanol" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="why-ethanol" class="callout-inner">
<h3 class="callout-title">Why ethanol?</h3>
<div class="callout-content">
<p>The <code>in.ethanol</code> LAMMPS input that we are using for this
exercise is an easily edited benchmark script used within EPCC to test
system performance. The intention of this script is to be easy to edit
and alter when running on varied core/node counts. By editing the
<code>X_LENGTH</code>, <code>Y_LENGTH</code>, and <code>Z_LENGTH</code>
variables, you can increase the box size substantially. As to the choice
of molecule, we wanted something small and with partial charges –
ethanol seemed to fit both of those.</p>
</div>
</div>
</div>
<p>You can submit your first job on ARCHER2 by running:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">sbatch</span> sub.slurm</span></code></pre>
</div>
<p>You can check the progress of your job by running
<code>squeue --me</code>. Your job state will go from <code>PD</code>
(pending) to <code>R</code> (running) to <code>CG</code> (cancelling).
Once your job is complete, it will have produced a file called
<code>slurm-####.out</code>, which contains the standard output and
standard error produced by your job.</p>
</div>
</section><section><h2 class="section-heading" id="a-brief-overview-of-the-lammps-log-file">A brief overview of the LAMMPS log file<a class="anchor" aria-label="anchor" href="#a-brief-overview-of-the-lammps-log-file"></a>
</h2>
<hr class="half-width">
<p>The job will also produce a LAMMPS log file <code>log.64_cpus</code>.
The name of the file will change when the number of tasks requested in
slurm are changed in the <code>sub.slurm</code> file. In this file, you
will find all of the thermodynamic outputs that were specified in the
LAMMPS <code>thermo_style</code>, as well as some very useful
performance information! We will explore the LAMMPS log file in more
details later but, for now, we will concentrate on the LAMMPS
performance information output at the end of the log file. This will
help us to understand what our simulation is doing, and where we can
speed it up.</p>
<p>Running:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">tail</span> <span class="at">-n</span> 28 log.64_cpus</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Performance: 12.825 ns/day, 1.871 hours/ns, 148.442 timesteps/s
100.0% CPU use with 64 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00020468 | 0.30021    | 2.1814     | 117.6 |  4.44
Bond    | 0.00014519 | 0.044983   | 0.2835     |  39.4 |  0.67
Kspace  | 0.43959    | 2.4307     | 2.7524     |  43.8 | 35.98
Neigh   | 3.608      | 3.6659     | 3.7229     |   1.9 | 54.27
Comm    | 0.091376   | 0.26108    | 0.34751    |  12.6 |  3.87
Output  | 0.0028102  | 0.0029118  | 0.003015   |   0.1 |  0.04
Modify  | 0.011717   | 0.045059   | 0.19911    |  23.7 |  0.67
Other   |            | 0.004113   |            |       |  0.06

Nlocal:        102.516 ave         650 max           0 min
Histogram: 44 12 0 0 0 0 0 1 1 6
Nghost:        922.078 ave        2505 max         171 min
Histogram: 8 24 0 7 17 0 0 0 2 6
Neighs:        18165.4 ave      136714 max           0 min
Histogram: 54 2 0 0 0 0 0 1 2 5

Total # of neighbors = 1162584
Ave neighs/atom = 177.19616
Ave special neighs/atom = 7.3333333
Neighbor list builds = 1000
Dangerous builds not checked
Total wall time: 0:00:13</code></pre>
</div>
<p>The ultimate aim is always to get your simulation to run in a
sensible amount of time. This often simply means trying to optimise the
final value (“Total wall time”), though some people care more about
optimising efficiency (wall time multiplied by core count).</p>
</section><section><h2 class="section-heading" id="increasing-computational-resources">Increasing computational resources<a class="anchor" aria-label="anchor" href="#increasing-computational-resources"></a>
</h2>
<hr class="half-width">
<p>The first approach that most people take to increase the speed of
their simulations is to increase the computational resources. If your
system can accommodate this, doing this can sometimes lead to “easy”
improvements. However, this usually comes at an increased cost (if
running on a system for which compute is charged) and does not always
lead to the desired results.</p>
<p>In your first run, LAMMPS was run on 64 cores. For a large enough
system, increasing the number of cores used should reduce the total run
time. In your <code>sub.slurm</code> file, you can edit the number of
tasks in the line:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#SBATCH --tasks-per-node=64</span></span></code></pre>
</div>
<p>to run on a different number of cores. An ARCHER2 node has 128 cores,
so you can run LAMMPS on up to 128 cores.</p>
<div id="quick-benchmark" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="quick-benchmark" class="callout-inner">
<h3 class="callout-title">Quick benchmark</h3>
<div class="callout-content">
<p>As a first exercise, fill in the table below.</p>
<table class="table">
<thead><tr class="header">
<th>Number of cores</th>
<th>Wall time</th>
<th>Performance (ns/day)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>2</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>4</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>8</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>16</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>32</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>64</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>128</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Do you spot anything unusual in these run times? If so, can you
explain this strange result?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The simulation takes almost the same amount of time when running on a
single core as when running on two cores. A more detailed look into the
<code>in.ethanol</code> file will reveal that this is because the
simulation box is not uniformly packed. We won’t go into all the details
in this course, but we do cover most of the available optimisations in
the advanced course.</p>
</div>
</div>
</div>
</div>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note</h3>
<div class="callout-content">
<p>Here we are only considering MPI parallelisation. LAMMPS offers the
option to run using joint MPI+OpenMP (more on that on the advanced
LAMMPS course), but for the exercises in this lesson, we will only be
considering MPI.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“LAMMPS is a versatile software used in a wide range of subjects to
run classical molecular dynamics simulations.”</li>
<li>“Running jobs on ARCHER2 requires a submission to the Slurm batch
system using specific account, budget, queue, and qos keywords.”</li>
<li>“Adding more cores is not always the most effective way of
increasing performance.”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-03-simulation-setup"><p>Content from <a href="03-simulation-setup.html">Setting up a simulation in LAMMPS</a></p>
<hr>
<p>Last updated on 2025-10-15 |

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/03-simulation-setup.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“How do we setup a simulation in LAMMPS?”</li>
<li>“What do all the commands in the input file mean?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Understand the commands, keywords, and parameters necessary to
setup a LAMMPS simulation.”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="intro-to-lammps-simulations">Intro to LAMMPS simulations<a class="anchor" aria-label="anchor" href="#intro-to-lammps-simulations"></a>
</h2>
<hr class="half-width">
<p>LAMMPS uses text files as input files that control the setup and flow
of a simulation, and a variety of file types (and other methods) initial
system for topologies.</p>
<p>Whether the simulation to run is MD or DEM, LAMMPS applies Newton’s
laws of motion to systems of particles that can range in size from
atoms, course-grained moieties, entire molecules, or even grains of
sand. In practical terms, the movement of the particles is calculated by
the simple repeating loop:</p>
<ol style="list-style-type: decimal">
<li>Take the initial positions of the particles in the simulation box
and calculate the total force that is applied to each particle, using
the chosen force-field.</li>
<li>Use the calculated forces to calculate the acceleration to add to
each particle.</li>
<li>Use the acceleration to calculate the new velocity of each
particle.</li>
<li>Use the the new velocity of each particle, and the defined
time-step, to calculate a new position for each particle.</li>
<li>Repeat ad nauseum.</li>
</ol>
<p>With the new particle positions, the cycle continues, one very small
time-step at a time.</p>
<figure><img src="../fig/MD.png" alt="Minimalistic representation of a 2D simulation of particles" class="figure mx-auto d-block"><div class="figcaption">Minimalistic representation of a 2D simulation
of particles</div>
</figure><p>With this in mind, we can take a look at a very simple example of a
LAMMPS input file, <code>in.pour</code>, and discuss each command – and
their related concepts – one by one. The order that the commands appear
in <strong>can</strong> be important, depending on the exact details.
Always refer to the <a href="lammps-manual">LAMMPS manual</a> to
check.</p>
<p>For this session, we’ll be looking at the
<code>2-pour-exercise/in.pour</code> file in your <code>exercises</code>
directory.</p>
</section><section><h2 class="section-heading" id="simulation-setup">Simulation setup<a class="anchor" aria-label="anchor" href="#simulation-setup"></a>
</h2>
<hr class="half-width">
<p>The first thing we have to do is chose a style of units. This can be
achieved by the <code>units</code> command:</p>
<pre><code>units         lj</code></pre>
<p>LAMMPS has several different <a href="https://docs.lammps.org/units.html" class="external-link">unit styles</a>, useful in
different types of simulations. In this example, we are using
<code>lj</code>, or Lennard-Jones (LJ) units. These are dimensionless
units, that are defined on the LJ potential parameters. They are
computationally advantageous because they’re usually close to unity, and
required less precise (lower number of bits) floating point variables –
which in turn reduced the memory requirements, and increased calculation
speed.</p>
<p>The next line defines what style of <code>atoms</code> (LAMMPS’s
terminology for particle) to use:</p>
<pre><code>atom_style    sphere</code></pre>
<p>The <a href="https://docs.lammps.org/atom_style.html" class="external-link">atom style</a>
impacts on what attributes each atom has associated with it – this
cannot be changed during a simulation. Every style stores: coordinates,
velocities, atom IDs, and atom types. The <code>sphere</code> style also
stores radius, mass, omega, and torque for each particle. Other styles
will store additional, or different, information.</p>
<p>We then define the number of dimensions in our system:</p>
<pre><code>dimension     3</code></pre>
<p>LAMMPS is also capable of simulating two-dimensional systems.</p>
<p>The boundary command sets the styles for the boundaries for the
simulation box.</p>
<pre><code>boundary      p p f</code></pre>
<p>Each of the three letters after the keyword corresponds to a
direction (x, y, z), and <code>p</code> means that the selected boundary
is to be periodic, while <code>f</code> means it’s fixed, that is,
LAMMPS won’t generate periodic images accross this dimension, and
particles won’t be able to go accross the limits of the simulation box
accross this dimension. Other boundary conditions are available
(shrink-wrapped, and shrink-wrapped with minimum).</p>
<figure><img src="../fig/PBC.png" alt="Periodic boundary conditions" class="figure mx-auto d-block"><div class="figcaption">Periodic boundary conditions</div>
</figure><p>Periodic boundary conditions (PBCs) allow the approximation of an
infinite system by simulating only a small part, a unit-cell. The most
common shapes of (3D) unit-cell is cuboidal, but any shape that
completely tessellates 3D space can be used. The topology of PBCs is
such that a particle leaving one side of the unit cell, it reappears on
the other side. A 2D map with PBC could be perfectly mapped to a
torus.</p>
<p>Another key aspect of using PBCs is the use of the
<strong>minimum-image convention</strong> for calculating interactions
between particles. This guarantees that each particle interacts only
with the closest <em>image</em> of another particle, no matter with
unit-cell (the original simulation box or one of the periodic images) it
belongs to.</p>
<p>Granular interactions depend on the velocity of neighbouring
particles, so we need to setup LAMMPS to communicate the velocities of
“ghost” particles between processors:</p>
<pre><code>comm_modify     vel yes</code></pre>
<p>The region command defines a geometric region in space.</p>
<pre><code>region          reg block -20 20 -20 20 0 40</code></pre>
<p>The arguments are <code>box</code>, a name we give to the region,
<code>block</code>, the type of region (cuboid), and the numbers are the
min and max values for x, y, and z.</p>
<p>We then create a box with two “atom” types, using the region we
defined previously</p>
<pre><code>create_box      2 reg</code></pre>
<div class="section level3">
<h3 id="inter-particle-interactions">Inter-particle interactions<a class="anchor" aria-label="anchor" href="#inter-particle-interactions"></a>
</h3>
<p>Now that we have a simulation box, we have to define how particles
will interact with each-other once we start adding them to the box.</p>
<p>The first line in this section defines the style of interaction our
particles will use.</p>
<pre><code>pair_style  granular</code></pre>
<p>LAMMPS has a large number of <a href="https://docs.lammps.org/pair_style.html" class="external-link">pairwise interparticle
interactions</a> available. In this case, we are using the granular pair
style, which supports a number of options for normal, tangential,
rolling, and twisting forces that result from the contact between
particles that need to be setup, using the commands:</p>
<pre><code>pair_coeff      1 * jkr 1000.0 50.0 0.3 10 tangential mindlin 800.0 1.0 0.5 rolling sds 500.0 200.0 0.5 twisting marshall
pair_coeff      2 2 hertz 200.0 20.0 tangential linear_history 300.0 1.0 0.1 rolling sds 200.0 100.0 0.1 twisting marshall</code></pre>
</div>
<div class="section level3">
<h3 id="neighbour-lists">Neighbour lists<a class="anchor" aria-label="anchor" href="#neighbour-lists"></a>
</h3>
<p>To improve simulation performance, and because we are truncating
interactions at a certain distance, we can keep a list of particles that
are close to each other (under a neighbour cutoff distance). This
reduces the number of comparisons needed per time-step, at the cost of a
small amount of memory.</p>
<figure><img src="../fig/cutoff.png" alt="Neighbour lists" class="figure mx-auto d-block"><div class="figcaption">Neighbour lists</div>
</figure><p>We can set our neighbour list cutoff to be 0.3σ greater than the
default cutoff – remember that, as we are dealing with spheres, a small
increase in radius results can result in a large volume increase.</p>
<p>The <code>bin</code> keyword refers to the algorithm used to build
the list, <code>bin</code> is the best performing algorithm for systems
with homogeneous sizes of particles, but there are <a href="https://docs.lammps.org/neighbor.html" class="external-link">others</a>.</p>
<pre><code>neighbor        0.3 bin</code></pre>
<p>These lists still need to be updated periodically. Provided that we
rebuild them more frequently than the minimum time it takes for a
particle to move from within the neighbour cutoff to outside of it. We
use the <code>neigh_modify</code> command to set the wait time between
each neighbour list rebuild:</p>
<pre><code>neigh_modify    delay 10 every 1</code></pre>
<p>The <code>delay</code> parameter sets the minimum number of
time-steps that need to pass since the last neighbour list rebuild for
LAMMPS to even consider rebuilding it again. The <code>every</code>
parameter tells LAMMPS to attempt to build the neighbour list if the
number of timesteps since the delay ended is equal to the
<code>every</code> value – by default, the rebuild will only be
triggered if an atom has moved more than half the neighbour skin
distance (the 0.3 above).</p>
<div id="how-to-set-neighbour-list-delays" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="how-to-set-neighbour-list-delays" class="callout-inner">
<h3 class="callout-title">How to set neighbour list delays?</h3>
<div class="callout-content">
<p>You can estimate the frequency at which you need to rebuild neighbour
lists by running a quick simulation with neighbour list rebuilds every
timestep:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">neigh_modify</span>    delay 0 every 1 check yes</span></code></pre>
</div>
<p>and looking at the resultant LAMMPS neighbour list information in the
log file generated by that run.</p>
<p>The Neighbour list builds tells you how often neighbour lists needed
to be rebuilt. If you know how many timesteps your short simulation ran
for, you can estimate the frequency at which you need to calculate
neighbour lists by working out how many steps there are per rebuild on
average. Provided that your update frequency is less than or equal to
that, you should see a speed up.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="simulation-parameters">Simulation parameters<a class="anchor" aria-label="anchor" href="#simulation-parameters"></a>
</h3>
<p>Now that we’ve set up the initial conditions for the simulation, and
changed some settings to make sure it runs a bit faster, all that is
left is telling LAMMPS exactly how we want the simulation to be run.
This includes, but is not limited to, what ensemble to use (and which
particles to apply it to), how big the time-step is, how many time-steps
we want to simulate, what properties we want as output, and how often we
want those properties logged.</p>
<p>The <code>fix</code> command has a <a href="https://docs.lammps.org/fix.html" class="external-link">myriad of options</a>, most of
them related to ‘setting’ certain properties at a value, or in an
interval of values for one, all, or some particles in the
simulation.</p>
<p>The first keywords are always <code>ID</code> – a name to reference
the fix by, and <code>group-ID</code> – which particles to apply the
command to. The most common option for the second keyword is
<code>all</code>.</p>
<pre><code>fix             1 all nve/sphere</code></pre>
<p>Then we have the styles plus the arguments. In the case above, the
style is <code>nve/sphere</code>, and there are no arguments.</p>
<p>Next, we enable gravity on our simulation:</p>
<pre><code>fix             grav all gravity 9.8 vector 0 0 -1</code></pre>
</div>
<div class="section level3">
<h3 id="pouring-particles">Pouring particles<a class="anchor" aria-label="anchor" href="#pouring-particles"></a>
</h3>
<p>To pour particles into our box, we need to setup a region where
particles can appear. We can create two cylindrical regions with the
commands:</p>
<pre><code>region          cyl1 cylinder z -10  9 10 20 35
region          cyl2 cylinder z  10 -9 10 20 35</code></pre>
<p>Here, the parameters after <code>cylinder</code> are: the direction
of the axis of the cylinder, the coordinates of the axis in the other
two dimensions, the radius, and the low- and high- coordinate along the
axis of the cylinder faces.</p>
<p>Then, we use the <code>fix pour</code> command to create particles in
our simulation box.</p>
<pre><code>#               ID   group-id style n_part type seed kw     region_id kw   d_style min_diam max_diam kw   min_dens max_dens
fix             ins1 all      pour  10000  1    3123 region cyl1      diam range   0.5      1        dens 1.0      1.0
fix             ins2 all      pour  10000  2    4567 region cyl2      diam range   0.5      1        dens 1.0      1.0</code></pre>
<p>Finally, we setup the properties of our bottom wall:</p>
<pre><code>fix             2 all wall/gran granular hertz/material 1e5 1e3 0.3 tangential mindlin NULL 1.0 0.5 zplane 0 NULL</code></pre>
</div>
<div class="section level3">
<h3 id="final-setup">Final setup<a class="anchor" aria-label="anchor" href="#final-setup"></a>
</h3>
<p>To have a valid simulation setup, we need to set the size of the
time-step, in whatever units we have chosen for this simulation – in
this case, LJ units.</p>
<pre><code>timestep      0.001</code></pre>
<p>The size of the time-step is a careful juggling of speed and
accuracy. A small time-step guarantees that no particle interactions are
missing, at the cost of a lot of computation time. A large time-step
allows for simulations that probe effects at longer time scales, but
risks a particle moving so much in each time-step, that some
interactions are missed – in extreme cases, some particles can ‘fly’
right through each other. The ‘happy medium’ depends on the system type,
size, and other variables.</p>
<p>The next line sets what thermodynamic information we want LAMMPS to
output to the terminal and the log file.</p>
<pre><code>thermo_style  custom step atoms</code></pre>
<p>There are several default styles, and the <code>custom</code> style
allows for full customisation of which fields and in which order to
write them.</p>
<p>In MD simulations (LAMMPS original use-case), losing an atom during
the simulation is a catastrophic mistake, so by default LAMMPS
terminates any simulation that looses particles with an error. To change
this behaviour for DEM simulations, use the <code>thermo_modify</code>
command:</p>
<pre><code>thermo_modify   lost ignore</code></pre>
<p>To set the frequency (in time-steps) at which these results are
output, you can vary the <code>thermo</code> command:</p>
<pre><code>thermo        100</code></pre>
<p>In this case, an output will be printed every 100 time-steps.</p>
<p>We can then select how to output the output trajectory files, we give
here two distinct options for different visualisation programs:</p>
<pre><code># for Ovito:
dump            1 all custom 100 dump.pour id type radius mass x y z
# for VTK:
dump            2 all vtk 100 pour*.vtk id type radius mass x y z
dump_modify     2 binary yes</code></pre>
<div id="nb---using-vtk" class="callout caution">
<div class="callout-square">
<i class="callout-icon" data-feather="alert-triangle"></i>
</div>
<span class="callout-header">Caution</span>
<div id="nb---using-vtk" class="callout-inner">
<h3 class="callout-title">NB - Using VTK</h3>
<div class="callout-content">
<p>For LAMMPS to be able to output in the VTK format, the executable
being used needs to have been compiled with the VTK package support.
This requires the system being used to have the VTK library installed.
The current version of LAMMPS on ARCHER2 does <em>not</em> have VTK
support.</p>
</div>
</div>
</div>
<p>And finally, we choose how many time-steps (<strong>not
time-units</strong>) to run the simulation for:</p>
<pre><code>run           10000</code></pre>
<div id="run-pour-simulation" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="run-pour-simulation" class="callout-inner">
<h3 class="callout-title">Run pour simulation</h3>
<div class="callout-content">
<p>What command does it take to submit the simulation to the ARCHER2
queue? What was the output?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">sbatch</span> sub.slurm</span></code></pre>
</div>
<p>We will inspect the logfile in detail on the next session.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“LAMMPS can simulate systems of many particles that are allowed to
interact, using any of a number of contact models.”</li>
<li>“A LAMMPS input file is a an ordered collection of commands with
both mandatory and optional arguments.”</li>
<li>“To successfully run a LAMMPS simulation, an input file needs to
cover basic simulation setup, read/create a system topology,
force-field, and type/frequency of outputs.”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-04-understanding-logfile"><p>Content from <a href="04-understanding-logfile.html">Understanding the logfile</a></p>
<hr>
<p>Last updated on 2025-10-15 |

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/04-understanding-logfile.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“What information does LAMMPS print to screen/logfile?”</li>
<li>“What does that information mean?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Understand the information that LAMMPS prints to screen / writes to
the logfile before, during, and after a simulation.”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="log-file">Log file<a class="anchor" aria-label="anchor" href="#log-file"></a>
</h2>
<hr class="half-width">
<p>The logfile is where we can find thermodynamic information of
interest. By default, LAMMPS will write to a file called
<code>log.lammps</code>. All info output to the terminal is replicated
in this file. We can change the name of the logfile by adding a
<code>log</code> command to your script:</p>
<pre><code>log     new_file_name.extension</code></pre>
<p>We can change which file to write to multiple times during a
simulation, and even <code>append</code> to a file if, for example, we
want the thermodynamic data separate from the logging of other assorted
commands. The thermodynamic data, which we setup with the
<code>thermo</code> and <code>thermo_style</code> command, create the
following (truncated) output:</p>
<pre><code>   Step        Atoms
         0           0
       100        3402
       200        3402
       300        3402
       400        3402</code></pre>
<p>At the start, we get a header with the column names, and then a line
for each time-step that’s a multiple of the value we set
<code>thermo</code> to. In this example we can see the number of
particle change as the simulation progresses. At the end of each
<code>run</code> command, we get the analysis of how the simulation time
is spent:</p>
<pre><code>Loop time of 27.0361 on 128 procs for 10000 steps with 20000 atoms

Performance: 31957.239 tau/day, 369.875 timesteps/s, 7.398 Matom-step/s
99.8% CPU use with 128 MPI tasks x 1 OpenMP threadsLoop time of 27.0361 on 128 procs for 10000 steps with 20000 atoms

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00044784 | 0.72334    | 18.078     | 340.9 |  2.68
Neigh   | 0.0029201  | 0.059077   | 1.0824     |  73.2 |  0.22
Comm    | 0.94043    | 15.311     | 20.813     | 142.0 | 56.63
Output  | 0.27547    | 0.84274    | 2.1389     |  59.9 |  3.12
Modify  | 5.4303     | 5.6532     | 6.4467     |   7.9 | 20.91
Other   |            | 4.447      |            |       | 16.45

Nlocal:         156.25 ave        2361 max           0 min
Histogram: 110 2 5 7 0 0 0 0 2 2
Nghost:        139.727 ave        1474 max           0 min
Histogram: 108 0 0 8 4 2 2 0 2 2
Neighs:        1340.88 ave       28536 max           0 min
Histogram: 112 7 5 0 0 0 0 0 2 2

Total # of neighbors = 171633
Ave neighs/atom = 8.58165
Neighbor list builds = 1000
Dangerous builds = 994
Total wall time: 0:00:28</code></pre>
<p>The data shown here is very important to understand the computational
performance of our simulation, and we can it to help improve the speed
at which our simulations run substantially. The first line gives us the
details of the last <code>run</code> command - how many seconds it took,
on how many processes it ran on, how many time-steps, and how many
atoms. This can be useful to compare between different systems.</p>
<p>Then we get some benchmark information:</p>
<pre><code>Performance: 31957.239 tau/day, 369.875 timesteps/s, 7.398 Matom-step/s
99.8% CPU use with 128 MPI tasks x 1 OpenMP threadsLoop time of 27.0361 on 128 procs for 10000 steps with 20000 atoms</code></pre>
<p>This tells us how many time units per day, how many time-steps per
second we are running, and how many “Mega-atom-step per second” which is
an easier measure to compare systems of different sizes (i.e., number of
particles). It also tells us how much of the available CPU resources
LAMMPS was able to use, and how many MPI tasks and OpenMP threads.</p>
<p>The next table shows a breakdown of the time spent on each task by
the MPI library:</p>
<pre><code>MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00044784 | 0.72334    | 18.078     | 340.9 |  2.68
Neigh   | 0.0029201  | 0.059077   | 1.0824     |  73.2 |  0.22
Comm    | 0.94043    | 15.311     | 20.813     | 142.0 | 56.63
Output  | 0.27547    | 0.84274    | 2.1389     |  59.9 |  3.12
Modify  | 5.4303     | 5.6532     | 6.4467     |   7.9 | 20.91
Other   |            | 4.447      |            |       | 16.45</code></pre>
<p>There are 8 possible MPI tasks in this breakdown:</p>
<ul>
<li>
<code>Pair</code> refers to non-bonded force computations</li>
<li>
<code>Bond</code> includes all bonded interactions, (so angles,
dihedrals, and impropers)</li>
<li>
<code>Kspace</code> relates to long-range interactions (Ewald, PPPM
or MSM)</li>
<li>
<code>Neigh</code> is the construction of neighbour lists</li>
<li>
<code>Comm</code> is inter-processor communication (AKA,
parallelisation overhead)</li>
<li>
<code>Output</code> is the writing of files (log and dump
files)</li>
<li>
<code>Modify</code> is the fixes and computes invoked by fixes</li>
<li>
<code>Other</code> is everything else</li>
</ul>
<p>Each category shows a breakdown of the least, average, and most
amount of wall time any processor spent on each category – large
variability in this (calculated as <code>%varavg</code>) indicates a
load imbalance (which can be caused by the atom distribution between
processors not being optimal). The final column, <code>%total</code>, is
the percentage of the loop time spent in the category.</p>
<div id="a-rule-of-thumb-for-total-on-each-category" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="a-rule-of-thumb-for-total-on-each-category" class="callout-inner">
<h3 class="callout-title">A rule-of-thumb for %total on each
category</h3>
<div class="callout-content">
<ul>
<li>
<code>Pair</code> and <code>modify</code>: as much as possible.</li>
<li>
<code>Neigh</code> and <code>Comm</code>: as little as possible. If
it’s growing large, it’s a clear sign that too many computational
resources are being assigned to a simulation.</li>
</ul>
</div>
</div>
</div>
<p>The next section is about the distribution of work amongs the
different threads:</p>
<pre><code>Nlocal:         156.25 ave        2361 max           0 min
Histogram: 110 2 5 7 0 0 0 0 2 2
Nghost:        139.727 ave        1474 max           0 min
Histogram: 108 0 0 8 4 2 2 0 2 2
Neighs:        1340.88 ave       28536 max           0 min
Histogram: 112 7 5 0 0 0 0 0 2 2</code></pre>
<p>The three subsections all have the same format: a title followed by
average, maximum, and minimum number of particles per processor,
followed by a 10-bin histogram of showing the distribution. The total
number of histogram counts is equal to the number of processors used.
The three properties listed are: - <code>Nlocal</code>: number of owned
atoms; - <code>Nghost</code>: number of ghost atoms; -
<code>Neighs</code>: pairwise neighbours.</p>
<p>The final section shows aggregate statistics accross all processors
for pairwise neighbours:</p>
<pre><code>Total # of neighbors = 171633
Ave neighs/atom = 8.58165
Neighbor list builds = 1000
Dangerous builds = 994</code></pre>
<p>It includes the number of total neighbours, the average number of
neighbours per atom, the number of neighbour list rebuilds, and the
number of <em>potentially dangerous</em> rebuilds. The <em>potentially
dangerous</em> rebuilds are ones that are triggered on the first
timestep that is checked. If this number is not zero, you should
consider reducing the delay factor on the <code>neigh_modify</code>
command.</p>
<p>The last line on every LAMMPS simulation will be the total wall time
for the entire input script, no matter how many <code>run</code>
commands it has:</p>
<pre><code>Total wall time: 0:00:28</code></pre>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“Thermodynamic information outputted by LAMMPS can be used to track
whether a simulations is running OK.”</li>
<li>“Performance data at the end of a logfile can give us insights into
how to make a simulation faster.”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-05-advanced-io-commands"><p>Content from <a href="05-advanced-io-commands.html">Advanced input and output commands</a></p>
<hr>
<p>Last updated on 2025-10-12 |

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/05-advanced-io-commands.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“How do I calculate a property every N time-steps?”</li>
<li>“How do I write a calculated property to file?”</li>
<li>“How can I use variables to make my input files easier to
change?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Understand the use of <code>compute</code>, <code>fix</code>, and
variables.”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="advanced-input-commands">Advanced input commands<a class="anchor" aria-label="anchor" href="#advanced-input-commands"></a>
</h2>
<hr class="half-width">
<p>LAMMPS has a very powerful suite for calculating, and outputting all
kinds of physical properties during the simulation. Calculations are
most often under a <a href="https://docs.lammps.org/computes.html" class="external-link">compute command</a>, and
then the output is handled by a <a href="https://docs.lammps.org/fixes.html" class="external-link">fix command</a>. We will now
look at some examples, but there are (at the time of writing) over 150
different <code>compute</code> commands with many options each.</p>
<div class="section level3">
<h3 id="lammps-trajectory-files">LAMMPS trajectory files<a class="anchor" aria-label="anchor" href="#lammps-trajectory-files"></a>
</h3>
<p>We can output information about a group of particles in our system by
using the LAMMPS <code>dump</code> command. In this example, we will be
outputting the particle positions, but you can output many other
attributes, such as particle velocities, types, angular momentum, etc.
The list of attributes (and examples of <code>dump</code> commands) can
be found in the <a href="https://docs.lammps.org/dump.html" class="external-link">relevant
LAMMPS manual page</a>.</p>
<p>If we look at the starting input script in
<code>exercises/3-advanced-inputs-exercise/in.lj_start</code>, we find
that the following command has been added:</p>
<pre><code>dump            1 all custom 100 rotating_drum.dump id type radius mass x y z</code></pre>
<p>The <code>dump</code> command defines the properties that we want to
output, and how frequently we want these output. In this case, we have
set the ID of the <code>dump</code> command to <code>1</code> (we could
have used any name/number and it would still work). We want to output
properties for <code>all</code> particles in our system. We’ve set the
output type to <code>custom</code> to have better control of what’s
being output – there are default <code>dump</code> options but
<code>custom</code> is generally the one that gets used. We’ll be
outputting every <code>100</code> time-steps to a file called
<code>nvt.lammpstrj</code> – a <code>*.lammpstrj</code> file can be
recognised by some post-processing and post-analysis tools as a LAMMPS
trajectory/dump file, and can save some time down the line. Finally, we
name the properties we want to output – in this case, we want to output
the particle ID, type, (x,y,z) components of position, and the (x, y, z)
components of velocity.</p>
<p>We’ve added a <code>dump_modify</code> command to get LAMMPS to sort
the output by ID order – we tell the <code>dump_modify</code> command
which <code>dump</code> command we’d like to sort by giving the dump-ID
(in this case, our <code>dump</code> command had an ID of
<code>1</code>). We then specify how we want to modify this
<code>dump</code> command – we want to <code>sort</code> it by ID, but
there are many more options (that you can find in the <a href="https://docs.lammps.org/dump_modify.html" class="external-link">LAMMPS manual</a>).</p>
<p>The output <code>rotating_drum.dump</code> file looks like this:</p>
<pre><code>ITEM: TIMESTEP
100
ITEM: NUMBER OF ATOMS
2741
ITEM: BOX BOUNDS pp pp ff
0.0000000000000000e+00 3.0000000000000000e+01
0.0000000000000000e+00 3.0000000000000000e+01
0.0000000000000000e+00 3.0000000000000000e+01
ITEM: ATOMS id type radius mass x y z
1 1 0.388095 0.244852 25.2758 16.9939 28.3519
2 1 0.485033 0.477973 24.1818 24.6876 27.6903
3 1 0.423595 0.318376 13.2428 21.4007 19.1017
4 1 0.353413 0.184899 7.58115 10.3236 26.5067
5 1 0.434095 0.342644 10.5736 17.2751 19.3327</code></pre>
<p>The lines with <code>ITEM:</code> let you know what is output on the
next lines (so <code>ITEM: TIMESTEP</code> lets you know that the next
line will tell you the time-step for this frame – in this case,
100,000). A LAMMPS trajectory file will usually contain the time-step,
number of atoms, and information on box bounds before outputting the
information we’d requested.</p>
</div>
<div class="section level3">
<h3 id="restart-files">Restart files<a class="anchor" aria-label="anchor" href="#restart-files"></a>
</h3>
<p>To allow the continuation of the simulation (with the caveat that it
must continue to run in the same number of cores as was originally
used), we can create a restart file.</p>
<p>This binary file contains information about system topology,
force-fields, but not about computes, fixes, etc, these need to be
re-defined in a new input file.</p>
<p>You can write a restart file with the command:</p>
<pre><code>write_restart drum.restart</code></pre>
<p>An arguably better solution is to write a data file, which not only
is a text file, but can then be used without restrictions in a different
hardware configuration, or even LAMMPS version.</p>
<pre><code>write_data  drum.data</code></pre>
<p>You can use a restart or data file to start/restart a simulation by
using a <code>read</code> command. For example:</p>
<pre><code>read_restart drum.restart</code></pre>
<p>will read in our restart file and use that final point as the
starting point of our new simulation.</p>
<p>Similarly:</p>
<pre><code>read_data drum.data</code></pre>
<p>will do the same with the data file we’ve output (or any other data
file).</p>
</div>
<div class="section level3">
<h3 id="radial-distribution-functions-rdfs">Radial distribution functions (RDFs)<a class="anchor" aria-label="anchor" href="#radial-distribution-functions-rdfs"></a>
</h3>
<p>Next, we will look at the Radial Distribution Function (RDF),
<em>g</em>(<em>r</em>). This describes how the density of a particles
varies as a function of the distance to a reference particle, compared
with a uniform distribution (that is, at r → ∞, <em>g</em>(<em>r</em>) →
1). We can make LAMMPS compute the RDF by adding the following lines to
our input script:</p>
<pre><code>compute        RDF all rdf 150 cutoff 3.5
fix            RDF_OUTPUT all ave/time 25 100 5000 c_RDF[*] file rdf.out mode vector</code></pre>
<p>We’ve named this <code>compute</code> command <code>RDF</code> and
are applying it to the atom-group <code>all</code>. The compute is of
style <code>rdf</code>, and we have set it to have with 150 bins for the
RDF histogram (e.g. there are 150 discrete distances at which atoms can
be placed). We’ve set a maximum cutoff of 3.5σ, above which we stop
considering particles.</p>
<p>Compute commands are instantaneous – they calculate the values for
the current time-step, but that doesn’t mean they calculate quantities
every time-step. A compute only calculates quantities when needed,
<em>i.e.</em>, when called by another command. In this case, we will use
our compute with the <code>fix ave/time</code> command, that averages a
quantity over time, and outputs it over a long timescale.</p>
<p>Our <code>fix ave/time</code> has the following parameters: -
<code>RDF_OUTPUT</code> is the name of the fix, <code>all</code> is the
group of particles it applies to. - <code>ave/time</code> is the style
of fix (there are many others). - The group of three numbers
<code>25 100 5000</code> are the <code>Nevery</code>,
<code>Nrepeat</code>, <code>Nfreq</code> arguments. These can be quite
tricky to understand, as they interplay with each other. -
<code>Nfreq</code> is how often a value is written to file. -
<code>Nrepeat</code> is how many sets of values we want to average over
(number of samples) - <code>Nevery</code> is how many time-steps in
between samples. - <code>Nfreq</code> must be a multiple of
<code>Nevery</code>, and <code>Nevery</code> must be non-zero even if
<code>Nrepeat = 1</code>. - So, for example, an <code>Nevery</code> of
2, with <code>Nrepeat</code> of 3, and <code>Nfreq</code> of 100: at
every time-step multiple of 100 (<code>Nfreq</code>), there will be an
average written to file, that was calculated by taking 3 samples
(<code>Nrepeat</code>), 2 time-steps apart (<code>Nevery</code>). So,
time-steps 96, 98, and 100 are averaged, and the average is written to
file. Likewise at time-steps 196, 198, and 200, etc. - In this case, we
take a sample every 25 time-steps, 100 times, and output at time-step
number 5000 – so from time-step 2500 to 5000, sampling every 25
time-steps. - <code>c_RDF[*]</code>, is the compute that we want to
average over time. <code>c_</code> defines that we’re wanting to use a
compute, and <code>RDF</code> is our compute name. The <code>[*]</code>
wildcard in conjunction with <code>mode vector</code> makes the fix
calculate the average for all the columns in the compute ID. - The
<code>file rdf_lj.out</code> argument tells LAMMPS where to write the
data to.</p>
<p>For this command, the file looks something like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># Time-averaged data for fix RDF_OUTPUT
# TimeStep Number-of-rows
# Row c_RDF[1] c_RDF[2] c_RDF[3]
100000 150
1 0.0116667 0 0
2 0.035 0 0
3 0.0583333 0 0
4 0.0816667 0 0
5 0.105 0 0
...
20 0.455 0 0
21 0.478333 0.334462 0.00227339
22 0.501667 1.9594 0.0169225
23 0.525 3.49076 0.0455044
24 0.548333 7.58762 0.113275
25 0.571667 9.36566 0.204196
...</code></pre>
</div>
<div id="yaml-output" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="yaml-output" class="callout-inner">
<h3 class="callout-title">YAML output</h3>
<div class="callout-content">
<p>Since version 4May2022 of LAMMPS, writing to YAML files support was
added. To write a YAML file, just change the extension accordingly
<code>file rdf_lj.yaml</code>. The file will then be in YAML format:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Time-averaged data for fix RDF_OUTPUT_YAML</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># TimeStep Number-of-rows</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co"># Row c_RDF[1] c_RDF[2] c_RDF[3]</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">keywords</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">'c_RDF[1]'</span><span class="kw">,</span><span class="at"> </span><span class="st">'c_RDF[2]'</span><span class="kw">,</span><span class="at"> </span><span class="st">'c_RDF[3]'</span><span class="kw">,</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">data</span><span class="kw">:</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="at">  </span><span class="fu">100000</span><span class="kw">:</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="kw">[</span><span class="fl">0.011666666666666691</span><span class="kw">,</span><span class="at"> </span><span class="dv">0</span><span class="kw">,</span><span class="at"> </span><span class="dv">0</span><span class="kw">,</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="kw">[</span><span class="fl">0.035000000000000045</span><span class="kw">,</span><span class="at"> </span><span class="dv">0</span><span class="kw">,</span><span class="at"> </span><span class="dv">0</span><span class="kw">,</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="kw">[</span><span class="fl">0.05833333333333334</span><span class="kw">,</span><span class="at"> </span><span class="dv">0</span><span class="kw">,</span><span class="at"> </span><span class="dv">0</span><span class="kw">,</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">...</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="variables-and-loops">Variables and loops<a class="anchor" aria-label="anchor" href="#variables-and-loops"></a>
</h2>
<hr class="half-width">
<p>LAMMPS input scripts can be quite complex, and it can be useful to
run the same script many times with only a small difference (for
example, temperature). For this reason, LAMMPS have implemented
variables and loops – but this doesn’t mean that we can only use
variables <em>with</em> loops.</p>
<p>A variable in LAMMPS is defined with the keyword
<code>variable</code>, then a <code>name</code>, and then style and
arguments, for example:</p>
<pre><code>variable        StepsPerRotation equal 20000.0
variable        theta equal 2*PI*elapsed/${StepsPerRotation}</code></pre>
<p>There are several <a href="https://docs.lammps.org/variable.html" class="external-link">variable styles</a>. Of
particular note are: - <code>equal</code> is the workhorse of the
styles, and it can set a variable to a number, <code>thermo</code>
keywords, maths operators or functions, among other things. -
<code>delete</code> unsets a variable. - <code>loop</code> and
<code>index</code> are similar, and will result in the variable changing
to the next value in a list every time a <code>next</code> command is
seen. The difference that <code>loop</code> accepts an integer or range,
while <code>index</code> accepts a list of strings.</p>
<p>To use a variable later in the script, just prepend a dollar sign,
like so:</p>
<pre><code>thermo_style    custom step atoms ke v_theta</code></pre>
<p>Example of loop:</p>
<pre><code>variable a loop 10
label loop
dump 1 all atom 100 file.$a
run 10000
undump 1
next a
jump SELF loop</code></pre>
<p>and of <code>index</code>:</p>
<pre><code>variable d index run1 run2 run3 run4 run5 run6 run7 run8
label loop
shell cd $d
read_data data.polymer
run 10000
shell cd ..
clear
next d
jump SELF</code></pre>
<div id="run-drum-at-several-speeds" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="run-drum-at-several-speeds" class="callout-inner">
<h3 class="callout-title">Run drum at several speeds</h3>
<div class="callout-content">
<p>Modify the files from exercise 3 to use a loop like described above
that rotates the drum at different speeds, for example, 5000, 10000, and
20000 steps per rotation.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># loop
variable        StepsPerRotation index 5000.0 10000.0 20000.0
label loop
# rotate drum
variable        theta equal 2*PI*elapsed/${StepsPerRotation}

dump            2 all custom 100 rotating_drum.$(2*PI/v_StepsPerRotation:%.5f).dump id type radius mass x y z

# run rotation
run             40000

undump 2
next StepsPerRotation
jump SELF loop</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“Using <code>compute</code> and <code>fix</code> commands, it’s
possible to calculate myriad properties during a simulation.”</li>
<li>“Variables make it easier to script several simulations.”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-06-lammps-performance"><p>Content from <a href="06-lammps-performance.html">Measuring and improving LAMMPS performance</a></p>
<hr>
<p>Last updated on 2025-10-12 |

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/06-lammps-performance.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 75 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“How can we improve the performance of LAMMPS?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Gain an overview of submitting and running jobs on the ARCHER2
service.”</li>
<li>“Gain an overview of methods to improve the performance of
LAMMPS.”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="performance-inprovements">Performance inprovements<a class="anchor" aria-label="anchor" href="#performance-inprovements"></a>
</h1>
<p>There are many configurable parameters in LAMMPS that can lead to
changes in performance. Some depend on the system being simulated,
others on the hardware being used. Here we will try to cover the most
relevant, using the ethanol system from the first exercise.</p>
<div class="section level2">
<h2 id="domain-decomposition">Domain decomposition<a class="anchor" aria-label="anchor" href="#domain-decomposition"></a>
</h2>
<p>In the earlier exercise, you will (hopefully) have noticed that,
while the simulation run time decreases overall as the core count is
increased, the run time was the same when run on one processor as it was
when run on two processors. This unexpected behaviour (for a truly
strong-scaling system, you would expect the simulation to run twice as
fast on two cores as it does on a single core) can be explained by
looking at our starting simulation configuration and understanding how
LAMMPS handles domain decomposition.</p>
<p>In parallel computing, domain decomposition describes the methods
used to split calculations across the cores being used by the
simulation. How domain decomposition is handled varies from problem to
problem. In the field of molecular dynamics (and, by extension, within
LAMMPS), this decomposition is done through spatial decomposition – the
simulation box is split up into a number of blocks, with each block
being assigned to their own core.</p>
<p>By default, LAMMPS will split the simulation box into a number of
equally sized blocks and assign one core per block. The amount of work
that a given core needs to do is directly linked to the number of atoms
within its part of the domain. If a system is of uniform density (i.e.,
if each block contains roughly the same number of particles), then each
core will do roughly the same amount of work and will take roughly the
same amount of time to calculate interactions and move their part of the
system forward to the next timestep. If, however, your system is not
evenly distributed, then you run the risk of having a number of cores
doing all of the work while the rest sit idle.</p>
<p>The system we have been simulating looks like this at the start of
the simulation:</p>
<figure><img src="../fig/start_sim_box.jpg" alt="Starting particle configuration" class="figure mx-auto d-block"><div class="figcaption">Starting system configuration</div>
</figure><p>As this is a system of non-uniform density, the default domain
decomposition will not produce the desired results.</p>
<p>LAMMPS offers a number of methods to distribute the tasks more evenly
across the processors. If you expect the distribution of atoms within
your simulation to remain constant throughout the simulation, you can
use a <code>balance</code> command to run a one-off re-balancing of the
simulation across the cores at the start of your simulation. On the
other hand, if you expect the number of atoms per region of your system
to fluctuate (e.g. as is common in evaporation), you may wish to
consider recalculating the domain decomposition every few timesteps with
the dynamic <code>fix balance</code> command.</p>
<p>For both the static, one-off <code>balance</code> and the dynamic
<code>fix balance</code> commands, LAMMPS offers two methods of load
balancing – the “grid-like” <code>shift</code> method and the “tiled”
<code>rcb</code> method. The diagram below helps to illustrate how these
work.</p>
<figure><img src="../fig/balance.jpg" alt="Different LAMMPS domain decomposition methods" class="figure mx-auto d-block"><div class="figcaption">Different LAMMPS domain decomposition
methods</div>
</figure><div id="using-better-domain-decomposition" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="using-better-domain-decomposition" class="callout-inner">
<h3 class="callout-title">Using better domain decomposition</h3>
<div class="callout-content">
<p>In your <code>in.ethanol</code> file, uncomment the
<code>fix balance</code> command and rerun your simulations. What do you
notice about the runtimes? We are using the dynamic load balancing
command – would the static, one-off <code>balance</code> command be
effective here?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The runtimes decrease significantly when running with dynamic load
balancing. In this case, static load balancing would not work as the
ethanol is still expanding to fill the simulation box. Once the ethanol
is evenly distributed within the box, you can remove the dynamic load
balancing.</p>
</div>
</div>
</div>
</div>
<div id="playing-around-with-dynamic-load-balancing" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="playing-around-with-dynamic-load-balancing" class="callout-inner">
<h3 class="callout-title">Playing around with dynamic load
balancing</h3>
<div class="callout-content">
<p>In the example, the <code>fix balance</code> is set to be
recalculated every 1,000 timesteps. How does the runtime vary as you
change this value? I would recommend trying 10, 100, and 10,000.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>The simulation time can vary drastically depending on how often
re-balancing is carried out. When using dynamic re-balancing, there is
an important trade-off between the time gained from re-balancing and the
cost involved with recalculating the load balance among cores.</p>
</div>
</div>
</div>
</div>
<p>You can find more information about how LAMMPS handles domain
decomposition in the LAMMPS manual <a href="https://docs.lammps.org/balance.html" class="external-link">balance</a>, and <a href="https://docs.lammps.org/fix_balance.html" class="external-link">fix balance</a>
sections.</p>
</div>
<div class="section level2">
<h2 id="considering-neighbour-lists">Considering neighbour lists<a class="anchor" aria-label="anchor" href="#considering-neighbour-lists"></a>
</h2>
<p>Let’s take another look at the profiling information provided by
LAMMPS:</p>
<pre><code>Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.063     | 68.063     | 68.063     |   0.0 | 34.51
Bond    | 5.0557     | 5.0557     | 5.0557     |   0.0 |  2.56
Kspace  | 5.469      | 5.469      | 5.469      |   0.0 |  2.77
Neigh   | 115.22     | 115.22     | 115.22     |   0.0 | 58.43
Comm    | 1.4039     | 1.4039     | 1.4039     |   0.0 |  0.71
Output  | 0.00034833 | 0.00034833 | 0.00034833 |   0.0 |  0.00
Modify  | 1.8581     | 1.8581     | 1.8581     |   0.0 |  0.94
Other   |            | 0.139      |            |       |  0.07</code></pre>
<p>There are 8 possible MPI tasks in this breakdown:</p>
<ul>
<li>
<code>Pair</code> refers to non-bonded force computations.</li>
<li>
<code>Bond</code> includes all bonded interactions, (so angles,
dihedrals, and impropers).</li>
<li>
<code>Kspace</code> relates to long-range interactions (Ewald, PPPM
or MSM).</li>
<li>
<code>Neigh</code> is the construction of neighbour lists.</li>
<li>
<code>Comm</code> is inter-processor communication (AKA,
parallelisation overhead).</li>
<li>
<code>Output</code> is the writing of files (log and dump
files).</li>
<li>
<code>Modify</code> is the fixes and computes invoked by fixes.</li>
<li>
<code>Other</code> is everything else.</li>
</ul>
<p>Each category shows a breakdown of the least, average, and most
amount of wall time any processor spent on each category – large
variability in this (calculated as <code>%varavg</code>) indicates a
load imbalance (which can be caused by the atom distribution between
processors not being optimal). The final column, <code>%total</code>, is
the percentage of the loop time spent in the category.</p>
<p>In the example above, we notice that the majority of the time is
spent in the <code>Neigh</code> section – e.g. a lot of time is spent
calculating neighbour lists. Neighbour lists are a common method for
speeding up simulations with short-ranged particle-particle
interactions. Most interactions are based on inter-particle distance and
traditionally the distance between every particle and every other
particle would need to be calculated every timestep (this is an <span class="math inline">\(O(N^2)\)</span> calculation!). Neighbour lists are
a way to reduce this to an <span class="math inline">\(\sim
O(N)\)</span> calculation for truncated short-ranged interactions.
Instead of considering all interactions between every particle in a
system, you can generate a list of all particles within the truncation
cutoff plus a little bit more. Depending on the size of that “little bit
more” and the details of your system, you can work out how quickly a
particle that is not in this list can move to be within the short-ranged
interaction cutoff. With this time, you can work out how frequently you
need to update this list.</p>
<figure><img src="../fig/neigh_list.jpg" alt="Neighbour list schematic" class="figure mx-auto d-block"><div class="figcaption">How LAMMPS selects what particles to include in
neighbour lists</div>
</figure><p>Doing this reduces the number of times that all inter-particle
distances need to be calculated: every few timestep, the inter-particle
distances for all particle pairs are calculated to generate the
neighbour list for each particle; and in the interim, only the
inter-particle distances for particles within a neighbour list need be
calculated (as this is a much smaller proportion of the full system,
this greatly reduces the total number of calculations).</p>
<p>If we dig a bit deeper into our <code>in.ethanol</code> LAMMPS input
file, we will notice the following lines:</p>
<pre><code>variable        NEIGH_TIME  equal      1    # neigh_modify every x dt

...

neigh_modify    delay 0 every ${NEIGH_TIME} check no</code></pre>
<p>These lines together indicate that LAMMPS is being instructed to
rebuild the full neighbour list every timestep (so this is not a very
good use of neighbour lists).</p>
<div id="changing-neighbour-list-update-frequency" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="changing-neighbour-list-update-frequency" class="callout-inner">
<h3 class="callout-title">Changing neighbour list update frequency</h3>
<div class="callout-content">
<p>Change the <code>NEIGH_TIME</code> variable to equal 10. How does
this affect the simulation runtime?</p>
<p>Now change the <code>NEIGH_TIME</code> variable to equal 1000. What
happens now?</p>
</div>
</div>
</div>
<p>Neighbour lists only give physical solutions when the update time is
less than the time it would take for a particle outwith the neighbour
cutoff to get to within the short-ranged interaction cutoff. If this
happens, the results generated by the simulation become questionable at
best and, in the worst case, LAMMPS will crash.</p>
<p>You can estimate the frequency at which you need to rebuild neighbour
lists by running a quick simulation with neighbour list rebuilds every
timestep:</p>
<pre><code>neigh_modify    delay 0 every 1 check yes</code></pre>
<p>and looking at the resultant LAMMPS neighbour list information in the
log file generated by that run.</p>
<pre><code>Total # of neighbors = 1313528
Ave neighs/atom = 200.20241
Ave special neighs/atom = 7.3333333
Neighbor list builds = 533
Dangerous builds = 0</code></pre>
<p>The <code>Neighbor list builds</code> tells you how often neighbour
lists needed to be rebuilt. If you know how many timesteps your short
simulation ran for, you can estimate the frequency at which you need to
calculate neighbour lists by working out how many steps there are per
rebuild on average. Provided that your update frequency is less than or
equal to that, you should see a speed up.</p>
<p>In this section, we only considered changing the frequency of
updating neighbour lists. Two other factors that can contribute to the
time taken to calculate neighbour lists are the <code>pair_style</code>
cutoff distances (where applicable) and the <code>neighbor</code> skin
distance. Decreasing either of these will reduce the number of particles
within the neighbour cutoff distance, thereby decreasing the number of
interactions being calculated each timestep. However, decreasing these
will mean that lists need to be rebuilt more frequently – it’s always a
fine balance.</p>
<p>You can find more information in the LAMMPS manual about <a href="https://docs.lammps.org/Developer_par_neigh.html" class="external-link">neighbour
lists</a> and the <a href="https://docs.lammps.org/neigh_modify.html" class="external-link">neigh_modify</a>
command.</p>
</div>
<div class="section level2">
<h2 id="submitting-multiple-sruns-in-one-job">Submitting multiple sruns in one job<a class="anchor" aria-label="anchor" href="#submitting-multiple-sruns-in-one-job"></a>
</h2>
<p>Jobs on ARCHER2 are charged by the node-hour. However, some
simulation systems are not big enough to justify a full node’s worth of
cores (128). In these cases, we can launch several <code>srun</code>
calls in one batch job, allowing us to make better use of the
computational resources.</p>
<p>Here is what the submission script for the <code>in.ethanol</code>
benchmarking that we used in an earlier lesson looks like, when we
launch all the powers of two number of cores, between 1 and 64, in one
single node:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#SBATCH --job-name=lmp_ex5</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#SBATCH --nodes=1</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#SBATCH --time=0:10:0</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#SBATCH --hint=nomultithread</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#SBATCH --distribution=block:block</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co"># The budget code of the project</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#SBATCH --account=ta215</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co"># Standard partition</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#SBATCH --partition=standard</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co"># Short QoS since our runtime is under 20m</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#SBATCH --qos=short</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co"># load the lammps module</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="ex">module</span> load lammps/29Aug2024</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co"># Set the number of threads to 1</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#   This prevents any threaded system libraries from automatically</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#   using threading.</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="bu">export</span> <span class="va">OMP_NUM_THREADS</span><span class="op">=</span>1</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co"># setup loop</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$(</span><span class="fu">seq</span> 0 6<span class="va">)</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>  <span class="va">cores</span><span class="op">=</span><span class="va">$((</span><span class="dv">2</span><span class="op">**</span><span class="va">$i))</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">"Running seq </span><span class="va">${i}</span><span class="st">: </span><span class="va">${cores}</span><span class="st"> cpu cores"</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>  <span class="ex">srun</span> <span class="at">--nodes</span><span class="op">=</span>1 <span class="at">--ntasks</span><span class="op">=</span><span class="va">${cores}</span> <span class="at">--ntasks-per-node</span><span class="op">=</span><span class="va">${cores}</span> <span class="at">--cpus-per-task</span><span class="op">=</span>1 <span class="at">--exact</span> <span class="dt">\</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>          <span class="at">--mem</span><span class="op">=</span>12500M lmp <span class="at">-i</span> in.ethanol <span class="at">-l</span> log.<span class="va">${cores}</span>_cpus <span class="kw">&amp;</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="co"># wait for all jobs to finish</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="bu">wait</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="hybrid-mpiopenmp-runs">Hybrid MPI+OpenMP runs<a class="anchor" aria-label="anchor" href="#hybrid-mpiopenmp-runs"></a>
</h2>
<p>When looking at the LAMMPS profiling information, we briefly
mentioned that the proportion of time spent calculating
<code>Kspace</code> should fall within the 10-30% region.
<code>Kspace</code> can often come to dominate the time profile when
running with a large number of MPI ranks. This is a result of the way
that LAMMPS handles the decomposition of k-space across multiple MPI
ranks.</p>
<p>One way to overcome this problem is to run your simulation using
hybrid MPI+OpenMP. To do this, you must ensure that you have compiled
LAMMPS with the <code>OMP</code> package. On ARCHER2, you can edit the
<code>run.slurm</code> file that you have been using to include the
following:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">#SBATCH --tasks-per-node=64</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task=2</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="bu">export</span> <span class="va">OMP_NUM_THREADS</span><span class="op">=</span>2</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="bu">export</span> <span class="va">SRUN_CPUS_PER_TASK</span><span class="op">=</span><span class="va">$SLURM_CPUS_PER_TASK</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="ex">srun</span> lmp <span class="at">-sf</span> omp <span class="at">-i</span> in.ethanol <span class="at">-l</span> <span class="va">${OMP_NUM_THREADS}</span>_log.out </span></code></pre>
</div>
<p>Setting the variable <code>OMP_NUM_THREADS</code> will let LAMMPS
know how many OpenMP threads will be used in the simulation. Setting
<code>--tasks-per-node</code> and <code>--cpus-per-task</code> will
ensure that Slurm assigns the correct number of MPI ranks and OpenMP
threads to the executable. Setting the LAMMPS <code>--sf omp</code> flag
will result in LAMMPS using the <code>OMP</code> version of any command
in your LAMMPS input script.</p>
<p>Running hybrid jobs efficiently can add a layer of complications, and
a number of additional considerations must be taken into account to
ensure the desired results. Some of these are:</p>
<ul>
<li>The product of the values assigned to <code>--tasks-per-node</code>
and <code>--cpus-per-task</code> should be less than or equal to the
number of cores on a node (on ARCHER2, that number is 128 cores).</li>
<li>You should try to restrict the number of OpenMP threads per MPI task
to fit on a single socket. For ARCHER2, the sockets (processors) are so
large that they have been subdivided into a number of NUMA regions. Each
ARCHER2 node 2 sockets, each socket has 4 NUMA regions, each of which
has 16 cores, for a total of 8 NUMA regions per node. Therefore, for an
efficient LAMMPS run, you would not want to use more than 16 OpenMP
processes per MPI task.</li>
<li>In a similar vein to the above, you also want to make sure that your
OpenMP threads are kept within a single NUMA region. Spanning across
multiple NUMA regions will decrease the performance
(significantly).</li>
</ul>
<p>These are only some of the things to bear in mind when considering
using hybrid MPI+OpenMP to speed up calculations.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“LAMMPS offers a number of built in methods to improve
performance.”</li>
<li>“It is important to spend some time understanding your system and
considering its performance.”</li>
<li>“Where possible, always run a quick benchmark of your system before
setting up a large run.”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div></section><section id="aio-07-compile"><p>Content from <a href="07-compile.html">Compiling LAMMPS</a></p>
<hr>
<p>Last updated on 2025-10-12 |

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/07-compile.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“How can I compile LAMMPS using CMake”</li>
<li>“How do I build LAMMPS with its shared libraries?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Know how to compile LAMMPS on ARCHER2 (and what to look for when
compiling elsewhere).”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="building-lammps-with-python">Building LAMMPS with Python<a class="anchor" aria-label="anchor" href="#building-lammps-with-python"></a>
</h2>
<hr class="half-width">
<p>For this course, we will be using a version of LAMMPS that has been
built with the “Python” package and with shared libraries. These will
help us ensure that we can run LAMMPS through Python.</p>
<p>The build instructions used can be found in the <a href="https://github.com/hpc-uk/build-instructions/blob/main/apps/LAMMPS/ARCHER2_2023-12-15_cpe2212.md" class="external-link">hpc-uk
github</a> and were:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># select centrally installed modules needed for compilation</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">module</span> load cpe/22.12</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="ex">module</span> load cray-fftw/3.3.10.3</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="ex">module</span> load cmake/3.21.3</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="ex">module</span> load cray-python</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># Add cray library paths to the LD_LIBRARY_PATH variable</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="bu">export</span> <span class="va">LD_LIBRARY_PATH</span><span class="op">=</span><span class="va">$CRAY_LD_LIBRARY_PATH</span>:<span class="va">$LD_LIBRARY_PATH</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># clone the chosen version of LAMMPS</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="fu">git</span> clone <span class="at">--depth</span><span class="op">=</span>1 <span class="at">--branch</span> stable_15Dec2023 https://github.com/lammps/lammps.git lammps-src-2023-12-15</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co"># create and source a virtual environment</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> venv <span class="at">--system-site-packages</span>  /work/y07/shared/apps/core/lammps/15_Dec_2023/venv/lammps-python-15-Dec-2023</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="bu">source</span> /work/y07/shared/apps/core/lammps/15_Dec_2023/venv/lammps-python-15-Dec-2023/bin/activate</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co"># creata folder for configuration and compilation</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="bu">cd</span> lammps-2023-12-15 <span class="kw">&amp;&amp;</span> <span class="fu">mkdir</span> build_cpe <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> build_cpe</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co"># use cmake to configure LAMMPS</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">-C</span> ../cmake/presets/most.cmake                                       <span class="dt">\</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>      <span class="at">-D</span> BUILD_MPI=on                                                      <span class="dt">\</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>      <span class="at">-D</span> BUILD_SHARED_LIBS=yes                                             <span class="dt">\</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>      <span class="at">-D</span> CMAKE_CXX_COMPILER=CC                                             <span class="dt">\</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>      <span class="at">-D</span> CMAKE_CXX_FLAGS=<span class="st">"-O2"</span>                                             <span class="dt">\</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>      <span class="at">-D</span> CMAKE_INSTALL_PREFIX=/path/to/install  <span class="dt">\</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>      <span class="at">-D</span> FFT=FFTW3                                                         <span class="dt">\</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>      <span class="at">-D</span> FFTW3_INCLUDE_DIR=<span class="va">${FFTW_INC}</span>                                     <span class="dt">\</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>      <span class="at">-D</span> FFTW3_LIBRARY=<span class="va">${FFTW_DIR}</span>/libfftw3_mpi.so                         <span class="dt">\</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>      <span class="at">-D</span> PKG_MPIIO=yes                                                     <span class="dt">\</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>      ../cmake/</span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="fu">make</span> <span class="at">-j</span> 8</span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="fu">make</span> install</span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a><span class="fu">make</span> install-python</span></code></pre>
</div>
<p>Of note here:</p>
<ul>
<li>
<code>-D CMAKE_INSTALL_PREFIX=/path/to/install</code> defines the
path into which your LAMMPS executables and libraries will be built. You
will need to change <code>/path/to/install</code> to whatever you
like.</li>
<li>
<code>-D BUILD_SHARED_LIBS=yes</code> will build the shared LAMMPS
library required to run LAMMPS in Python.</li>
<li>
<code>-D PKG_PYTHON=yes</code> will build the Python packages.</li>
<li>The <code>-C ../cmake/presets/most.cmake</code> command adds the
packages that we are installing. Not all of them are required for this
course, but it includes all packages that don’t need extra
libraries.</li>
<li>The rest of the instructions are to ensure that the correct compiler
is used, the MPI version of LAMMPS is built, and that it has access to
the correct fast Fourier transform (FFTW) and Eigen3 libraries.</li>
</ul>
<p>Once this is built, you should be able to run LAMMPS from the compute
nodes by loading the appropriate module.</p>
</section><section><h2 class="section-heading" id="building-lammps-with-vtk---local-linux-system">Building LAMMPS with VTK - local linux system<a class="anchor" aria-label="anchor" href="#building-lammps-with-vtk---local-linux-system"></a>
</h2>
<hr class="half-width">
<p>To vuild LAMMPS with VTK on an Ubuntu/Debian system (or virtual
machine), you will need to install the following pre-requesites:</p>
<ul>
<li>Compiler (gcc or clang)</li>
<li>MPI</li>
<li>VTK</li>
<li>FFTW3</li>
<li>Optionally, python</li>
</ul>
<p>To do this, you can use the aptitude package manager:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">sudo</span> apt install libvtk9-dev openmpi-bin openmpi-common python3-dev libfftw3-dev</span></code></pre>
</div>
<div class="section level3">
<h3 id="download-lammps">Download LAMMPS<a class="anchor" aria-label="anchor" href="#download-lammps"></a>
</h3>
<p>Clone the latest stable version of LAMMPS from the GitHub
repository:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">git</span> clone <span class="at">--depth</span><span class="op">=</span>1 <span class="at">--branch</span> stable_22Jul2025_update1 https://github.com/lammps/lammps.git lammps-2025-09-02</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="optional---for-python-support">Optional - for Python support<a class="anchor" aria-label="anchor" href="#optional---for-python-support"></a>
</h3>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># create</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> venv <span class="at">--system-site-packages</span> /path/to/venv/lammps-2025-09-02</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co"># and source a virtual environment</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="bu">source</span> /path/to/venv/lammps-2025-09-02/bin/activate</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="regular-mpi-executable-and-python-wrappers">Regular MPI executable and python wrappers<a class="anchor" aria-label="anchor" href="#regular-mpi-executable-and-python-wrappers"></a>
</h3>
<p>Create and go into a build directory:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="bu">cd</span> lammps-2025-09-02 <span class="kw">&amp;&amp;</span> <span class="fu">mkdir</span> build_cpe <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> build_cpe</span></code></pre>
</div>
<p>Build using:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">cmake</span> <span class="at">-C</span> ../cmake/presets/most.cmake            <span class="dt">\</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>      <span class="at">-D</span> PKG_VTK=yes                            <span class="dt">\</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>      <span class="at">-D</span> BUILD_MPI=on                           <span class="dt">\</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>      <span class="at">-D</span> BUILD_SHARED_LIBS=yes                  <span class="dt">\</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>      <span class="at">-D</span> CMAKE_CXX_FLAGS=<span class="st">"-O2"</span>                  <span class="dt">\</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>      <span class="at">-D</span> CMAKE_INSTALL_PREFIX=/path/to/install  <span class="dt">\</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>      <span class="at">-D</span> FFT=FFTW3                              <span class="dt">\</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>      ../cmake/</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">make</span> <span class="at">-j</span> 8</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="fu">make</span> install</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="fu">make</span> install-python</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="bu">export</span> <span class="va">LD_LIBRARY_PATH</span><span class="op">=</span>/path/to/install/lib:<span class="va">$LD_LIBRARY_PATH</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="bu">export</span> <span class="va">PATH</span><span class="op">=</span>/path/to/install/bin:<span class="va">$PATH</span></span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“Compiling LAMMPS with CMake is easy and quick on ARCHER2”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-08-lammps-python"><p>Content from <a href="08-lammps-python.html">Running LAMMPS through Python</a></p>
<hr>
<p>Last updated on 2025-10-14 |

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/episodes/08-lammps-python.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“How can I run LAMMPS from within Python?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Know how run a LAMMPS simulation through Python.”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="running-lammps-through-python">Running LAMMPS through Python<a class="anchor" aria-label="anchor" href="#running-lammps-through-python"></a>
</h2>
<hr class="half-width">
<p>Running LAMMPS through Python is quite a simple task: you can import
the LAMMPS Python library, start the LAMMPS environment, and run a
LAMMPS simulation by running the following commands:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">from</span> lammps <span class="im">import</span> lammps</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    lmp <span class="op">=</span> lammps()</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    lmp.<span class="bu">file</span>(<span class="st">"in.pour"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    main()</span></code></pre>
</div>
<p>Python will use the shared LAMMPS libraries to run this. Under the
hood, LAMMPS runs the same processes as it would if the script was run
directly through the LAMMPS executable, and jobs run with Python will
run in comparable times.</p>
<p>One of the main advantages of running LAMMPS through Python is that
it allows you to make use of Python’s dynamic programming. Also, while
LAMMPS offers a large amount of options for writing scripts (via
e.g. <code>variables</code> definition, <code>jump</code> commands and
<code>if</code> statements), these are not as intuitive to a lot of
users as a Python interface.</p>
<div class="section level3">
<h3 id="exercise">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<p>We have prepared an example on how to call LAMMPS from python. To
access this, please <code>cd exercises/6-python/</code>. In this
directory you will find three files:</p>
<ul>
<li>
<code>in.drum</code> is the LAMMPS input file adapted from an
earlier exercise with a rotating drum.</li>
<li>
<code>lammps_drum.py</code> is a Python script that initially runs
the simulation defined in the <code>in.drum</code> LAMMPS configuration
file. Once that is complete, the script will launch a series of
simulations run with changing rotating drum speeds</li>
<li>
<code>sub.slurm</code> is the Slurm submission script for running
this simulation on the ARCHER2 compute nodes.</li>
</ul>
<p>You can submit this simulation to the queue by running:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">sbatch</span> sub.slurm</span></code></pre>
</div>
<p>One disadvantage of using the LAMMPS python module is that debugging
can be more complicated when things go wrong. There are more moving
parts than with the LAMMPS executable, and it can often be difficult to
trace back errors and attribute them correctly to LAMMPS, Python, or the
interface.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>The LAMMPS python module has a number of other features and variables
that can be called to improve your use of LAMMPS through Python. You can
find more information about this in the <a href="https://docs.lammps.org/Python_module.html" class="external-link">LAMMPS manual</a>.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>“Running LAMMPS through Python can have certain advantages.”</li>
<li>“However, finding the root cause of problems when things go wrong is
harder to do when running LAMMPS through Python rather than through a
LAMMPS executable.”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/" class="external-link">Source</a></p>
				<p><a href="https://github.com/EPCCed/archer2-lammps-ccc-parasols/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:r.apostolo@epcc.ed.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.17.1" class="external-link">sandpaper (0.17.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.7" class="external-link">varnish (1.0.7)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://EPCCed.github.io/archer2-lammps-ccc-parasols/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, lammps, archer2, dem",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://EPCCed.github.io/archer2-lammps-ccc-parasols/instructor/aio.html",
  "identifier": "https://EPCCed.github.io/archer2-lammps-ccc-parasols/instructor/aio.html",
  "dateCreated": "2025-10-15",
  "dateModified": "2025-10-15",
  "datePublished": "2025-10-15"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

